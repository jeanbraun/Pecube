<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="Jean Braun">
<title>Pecube User Guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1><strong>Pecube</strong> User Guide</h1>
<div class="details">
<span id="author" class="author">Jean Braun</span><br>
<span id="email" class="email"><a href="mailto:jbraun@gfz-potsdam.de">jbraun@gfz-potsdam.de</a></span><br>
<span id="revnumber">version 4.0,</span>
<span id="revdate">11-09-2018</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_getting_started">Getting started</a></li>
<li><a href="#_installation">Installation</a></li>
<li><a href="#_running_pecube">Running <strong>Pecube</strong></a>
<ul class="sectlevel2">
<li><a href="#_pecube">PECUBE</a></li>
<li><a href="#_mpi_version">MPI version</a></li>
<li><a href="#_vtk_postprocessor">VTK Postprocessor</a></li>
<li><a href="#_input_file_tester">Input file tester</a></li>
<li><a href="#_using_old_input_files">Using old input files</a></li>
</ul>
</li>
<li><a href="#_file_structure">File structure</a>
<ul class="sectlevel2">
<li><a href="#_bin">bin</a></li>
<li><a href="#_src">src</a></li>
<li><a href="#_tools">tools</a></li>
<li><a href="#_docs">docs</a></li>
<li><a href="#_tmp">tmp</a></li>
<li><a href="#_old_input">old_input</a></li>
<li><a href="#_project_folders">project folders</a></li>
<li><a href="#_topo">topo</a></li>
</ul>
</li>
<li><a href="#_main_input_file">Main input file</a>
<ul class="sectlevel2">
<li><a href="#_topography_parameters">Topography parameters</a></li>
<li><a href="#_time_evolution_parameters">Time evolution parameters</a></li>
<li><a href="#_thermal_parameters">Thermal parameters</a></li>
<li><a href="#_data_parameters">Data parameters</a></li>
<li><a href="#_tectonic_parameters">Tectonic parameters</a></li>
<li><a href="#_output_parameters"> Output parameters</a></li>
<li><a href="#_isostasy_parameters">Isostasy parameters</a></li>
<li><a href="#Inversion_parameters">Inversion parameters</a></li>
<li><a href="#_miscellaneous_flags">Miscellaneous flags</a></li>
</ul>
</li>
<li><a href="#_output">Output</a>
<ul class="sectlevel2">
<li><a href="#_types_and_formats">Types and formats</a></li>
<li><a href="#_csv_files">CSV files</a></li>
<li><a href="#_vtk_files">VTK files</a></li>
<li><a href="#_bin_files">BIN files</a></li>
<li><a href="#_log_file">Log file</a></li>
</ul>
</li>
<li><a href="#_feeding_data_to_pecube">Feeding data to Pecube</a>
<ul class="sectlevel2">
<li><a href="#_conventions">Conventions</a></li>
<li><a href="#_data_types">Data types</a></li>
<li><a href="#_checking_the_data">Checking the data</a></li>
</ul>
</li>
<li><a href="#_inversion">Inversion</a>
<ul class="sectlevel2">
<li><a href="#_parameters_to_invert_for">Parameters to invert for</a></li>
<li><a href="#_misfit_function">Misfit function</a></li>
<li><a href="#_na_behaviour">NA behaviour</a></li>
<li><a href="#_inversion_results">Inversion results</a></li>
</ul>
</li>
<li><a href="#_examples">Examples</a>
<ul class="sectlevel2">
<li><a href="#_exmp1">EXMP1</a></li>
<li><a href="#_exmp2">EXMP2</a></li>
<li><a href="#EXMP3">EXMP3</a></li>
<li><a href="#_exmp4">EXMP4</a></li>
<li><a href="#_exmp5">EXMP5</a></li>
<li><a href="#EXMP6">EXMP6</a></li>
<li><a href="#_exmp7">EXMP7</a></li>
<li><a href="#_exmp8">EXMP8</a></li>
<li><a href="#_exmp9">EXMP9</a></li>
<li><a href="#_exmpa">EXMPA</a></li>
<li><a href="#_exmpb">EXMPB</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><strong>Pecube</strong> is a software designed to interpret thermochronological data by solving the heat equation in 3D in the crust.</p>
</div>
<div class="paragraph">
<p><strong>Pecube</strong> is often referred to as a `thermo-kinematic' model because the velocity field used in the advection term of the heat equation is specified by the user, not derived from a dynamical model. However, <strong>Pecube</strong> is more than a simple thermo-kinematic model because it allows for a finite amplitude, time varying surface topography. Temperature histories are computed for rock particles that will end up at the surface of the model. Rock paths are computed assuming a simple block uplift or motion along faults. From the temperature histories, <strong>Pecube</strong> compute ages for a variety of thermochronological systems that are compared to observed ages and/or displayed. <strong>Pecube</strong> can also be run in <em>Inversion</em> mode by finding the optimum values of given model parameters within a specified range that minimize a misfit function. The misfit function is the norm of the difference between observations and predictions. The optimization is performed using the Neighbourhood Algorithm.</p>
</div>
<div class="paragraph">
<p><strong>Pecube</strong> is intended to help thermochronologists in interpreting their data. It transforms tectonic and geomorphic scenarios into thermal histories that are computed to produce synthetic ages. In this latest version of <strong>Pecube</strong>, thermal histories extracted from the data using other pieces of software (such as QTQT or HEFTY) can be used as constraints rather than the ages themselves. This is a simple way to combine the strength of other pieces of software, which focus on predicting probable thermal histories to the strength of <strong>Pecube</strong>, which focus on predicting probable tectono-geomorphic scenarios.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started">Getting started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To run <strong>Pecube</strong>, you must use line-commands inside a shell or terminal window. <strong>Pecube</strong> does not have a fancy User Interface. To unlock all functionalities inside <strong>Pecube</strong>, you must also have installed Paraview, R, gfortran, gcc and mpi (in order of importance) on your computer. These are compilers and interpreters that are needed to transform the code and script files that are provided to you in the distribution file into executalbes. Executables have been created and included in the distribution that should allow you to run <strong>Pecube</strong> on a MacIntosch computer or a PC.</p>
</div>
<div class="paragraph">
<p>To run <strong>Pecube</strong> on a Mac, simply go to the main <strong>Pecube</strong> folder and issue the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>bin/run.sh EXMP1</pre>
</div>
</div>
<div class="paragraph">
<p>This will execute a script that will perform a series of operations, including running <strong>Pecube</strong> from a default (or example) input file: <code>EXMP1/input/Pecube.in</code>. Once this operation is performed (it should take a few minutes on a reasonably fast computer), you can look at the output generated by <strong>Pecube</strong> in the <code>EXMP1/output</code> folder. You can open any of the <code>.vtk</code> files using Paraview. You can also open any of the <code>.csv</code> files in Excel or Number. They contain summary information of the <strong>Pecube</strong> run output you just performed.</p>
</div>
<div class="paragraph">
<p>On a PC, you should execute the following comand:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>bin\run.bat EXMP1</pre>
</div>
</div>
<div class="paragraph">
<p>or, after making sure that the <code><strong>Pecube</strong>/bin</code> directory is included in your <code>PATH</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>run.bat EXMP1</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation">Installation</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you can read this User Guide, it means that you have already managed to perform at least one of the important steps in installing <strong>Pecube</strong>: opening the tarball `Pecube_v4.0.tar.gz.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For a basic installation of <strong>Pecube</strong>, you only need a computer running MacOSX, Linux or Windows. The <strong>Pecube</strong> tarball includes executables for MacOSX and Windows. If you have installed gfortran and gcc compilers, you will be able to create the required executables for your system by compiling Pecube. On a Windows machine you will also need a <code>make</code> facility such as <code>mingw32-make</code>. For a complete installation of <strong>Pecube</strong>, you will need gfortran and gcc compilers, an MPI installation and two other pieces of (free) software: <code>Paraview</code>, the kitware VTK viewer, and <code>R</code>, the statistical package.</p>
</div>
<div class="paragraph">
<p>Installation procedure for a basic installation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>untar the tarball:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>tar -xzvf Pecube_v4.0.tar.gz</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>go to the main <strong>Pecube</strong> directory:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>cd Pecube</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>run <strong>Pecube</strong>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>bin/run.sh EXMP1</pre>
</div>
</div>
<div class="paragraph">
<p>Installation procedure for a complete installation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>after obtaining a basic installation, modify a piece of code:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>touch src/Pecube.f90</pre>
</div>
</div>
<div class="paragraph">
<p>and compile the code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>bin/compile.sh</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>and check that the new version runs properly:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>bin/run.sh EXMP1</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running_pecube">Running <strong>Pecube</strong></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_pecube">PECUBE</h3>
<div class="listingblock">
<div class="content">
<pre>bin/run.sh $NAME</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>$NAME</code> is the name of a project, i.e., a folder the user has created that contains at minima an <code>input</code> directory in which the main <strong>Pecube</strong> input file <code>Pecube.in</code> is stored. This will run the input file tester <code>bin/Test</code>, <strong>Pecube</strong> itself <code>bin/Pecube</code>, and the VTK post-processor <code>bin/Vtk</code>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In the previous version of <strong>Pecube</strong> (version 3), the name of the project was contained in the topographic input file. In <strong>Pecube</strong> version 4 (2018) the user needs to specify the name of the project folder in the command line that starts <strong>Pecube</strong>. This is a major difference between this new version 4 (2018) and the previous version 3.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>$NAME</code>, the name of the project folder, is exactly 5 characters in length (like RUN01, NZ00A ot TEST1)</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Pecube</strong> will echo the content of the input file (if the <code>echo_input_file</code> flag has been set) to the default output (screen/terminal) and provide information about the progress of the run as it progresses.</p>
</div>
<div class="paragraph">
<p>In <em>Inversion</em> mode, the output is limited to one line per run.</p>
</div>
</div>
<div class="sect2">
<h3 id="_mpi_version">MPI version</h3>
<div class="listingblock">
<div class="content">
<pre>mpiexec -np $n bin/PecubeMPI.sh $NAME</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>$n</code> is the number of processors/cores/threads to be used by <strong>Pecube</strong>. This will run <code>$n</code> instances of <strong>Pecube</strong> simultaneously on the <code>$n</code> processors.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The MPI version should only be use din <em>Inversion</em> mode as <strong>Pecube</strong> cannot take advantage of multi-processor architecture for a single run.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vtk_postprocessor">VTK Postprocessor</h3>
<div class="paragraph">
<p>The user may select to run the VTK post-processor only by issuing the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>bin/Vtk $NAME</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_input_file_tester">Input file tester</h3>
<div class="paragraph">
<p>The user may select to run the input file tester only by issuing the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>bin/Test $NAME</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_old_input_files">Using old input files</h3>
<div class="paragraph">
<p>To allow easy migration to the <strong>Pecube</strong> version 4 (2018), a utility called Pecube324 is provided that transform the two input files <code>topo_parameters.txt</code> and <code>fault_parameters.txt</code> needed in the version 2 of <strong>Pecube</strong> into a single input file <code>Pecube.in</code> for <strong>Pecube</strong> version 3. To run the procedure, first copy the two version 2 input files in the folder <code>old_input</code> and run the <code>bin/Pecube324</code> utility:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>bin/Pecube324</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_file_structure">File structure</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Pecube</strong> exists inside of a strict file structure that is designed to help you organize your <strong>Pecube</strong> projects. It is summarized in the following diagram.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/files.jpg" alt="**Pecube** File Structure">
</div>
</div>
<div class="paragraph">
<p>The <code>bin</code> folder contains the executables produced at compilation and that need to be used to run <strong>Pecube</strong>. The <code>src</code> folder contains the FOrtran (and C) code. The <code>tools</code> folder contains a few tools such as <code>NA.R</code> the R-script used for displaying the results of inversions or <code>GenerateTimes.fio</code>, a Fortran code to generate file names in a sequence. The <code>docs</code> folder contains the documentation as well as all the elements needed to update it (figures and the <code>Pecube.adoc</code> file). The <code>tmp</code> folder contains intermediary files created during a <strong>Pecube</strong> run. It should not be changed/eroased. The <code>old_input</code> is used to translate old <strong>Pecube</strong> input files (form V2) into a new input file (V3). The <code>topo</code> folder shold contain the <code>Topo30</code> file that contains the global world topography (see section <a href="#TOPOGRAPHY">Topography parameters</a>) for details. The other folders correspond to distinct <strong>Pecube</strong> projects. You should create one folder per idea/dataset/location/etc.</p>
</div>
<div class="sect2">
<h3 id="_bin">bin</h3>
<div class="paragraph">
<p>This folder contains several shell scripts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>run.sh: used to run <strong>Pecube</strong></p>
</li>
<li>
<p>crun.sh: used to compile <strong>Pecube</strong> and all its components AND run Peccube</p>
</li>
<li>
<p>compile.sh: used to compile <strong>Pecube</strong> and all its components</p>
</li>
<li>
<p><code>tarngo.sh</code>: shell script to create a new <strong>Pecube</strong> tarball; to use it, one must be in the main <strong>Pecube</strong> folder and issue the command <code>tools/tarngo.sh VERSION</code> where <code>VERSION</code> is a version number or tag that will be added to the name of the tarball: <code>Pecube_VERSION.tar.gz</code>.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>crun.sh and compile.sh will work ONLY if you have <code>gfortran</code>, <code>gcc</code> and <code>mpi</code> properlyt installed on your computer</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>as well as some executables:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Pecube: <strong>Pecube</strong> executable</p>
</li>
<li>
<p>Vtk: executable to produce VTK output files after a <strong>Pecube</strong> run</p>
</li>
<li>
<p>Test: executable to produce VTK geometry files (such as topography, fault geometry, and velocity) before a <strong>Pecube</strong> run to check the validity of an input file</p>
</li>
<li>
<p>PecubeMPI: <strong>Pecube</strong> executable for multi-processor machines</p>
</li>
<li>
<p>Pecube324: Executable to transform &#8220;old format&#8221; <strong>Pecube</strong> input files to the &#8220;new format&#8221; input file</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Don&#8217;t forget that to run <strong>Pecube</strong> or to perform any operation, the corresponding command muyst be issued form the main <strong>Pecube</strong> folder</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_src">src</h3>
<div class="paragraph">
<p>This folder contains the complete set of ForTran and C subroutines that make up <strong>Pecube</strong>. They are all necessary for the user to compile <strong>Pecube</strong>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The content of the <code>src</code> folder should only be accessed/modified by expert users or developers. It is not recommended that you change any of the source files to perform an operation that could be accessed through the proper set of parameters or to perform an operation for q=which <strong>Pecube</strong> has not been designed.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_tools">tools</h3>
<div class="paragraph">
<p>This folder contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>NA.R</code>: R-script used for displaying the results of inversions</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_docs">docs</h3>
<div class="paragraph">
<p>This folder contains the documentation. It includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Pecube.adoc</code>: the User Guide in <code>.adoc</code> format that is used to generate the <code>.html</code> version using asciidoc</p>
</li>
<li>
<p><code>Pecube.html</code>: the User guide for display on a web browser</p>
</li>
<li>
<p><code>Pecube.pdf</code>: the User guide in pdf format</p>
</li>
<li>
<p><code>asciidoc.conf</code>: configuration file for asciidoc</p>
</li>
<li>
<p><code>images</code>: a folder containing a few images/figures used in the User Guide</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_tmp">tmp</h3>
<div class="paragraph">
<p>This folder contains intermediary files that are created when <strong>Pecube</strong> is executed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If this folder becomes too voluminous, the user may erase its content. But the folder itself must exist for <strong>Pecube</strong> to run.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_old_input">old_input</h3>
<div class="paragraph">
<p>This is where the user should put the &#8220;old format&#8221; <strong>Pecube</strong> input files, namely <code>topo_parameters.txt</code> and <code>fault_parameters.txt</code> to be transformed/translated to the new format. To perform this translation, the user should then run the <code>Pecube324</code> executable. <code>Pecube324</code> will read the name of the run in <code>topo_parameters.txt</code> and will create a folder of the same name where the new input file <code>Pecube.in</code> will be stored (in the <code>data</code> folder)</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You must be in the main <strong>Pecube</strong> folder to perform this operation and issue the command <code>bin/Pecube324</code></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_project_folders">project folders</h3>
<div class="paragraph">
<p>For each project, the user should create a project folder. For backward compatibility, the name of the folder corresponding to any given project must be composed of 5 characters, such as <code>RUN01</code> or <code>KINGC</code> or <code>00027</code>. Each project folder should contain, at minima, an other directory called <code>input</code>. In this directory should be a file named <code>Pecube.in</code>. This is the main (and only) input file containing the value of all <strong>Pecube</strong> model parameters.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The user should not use space (blank characters) for the project folder names&#8230;&#8203;</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The project folders may also contain a <code>data</code> folder that contains the data collected by the user and used to constrain a <strong>Pecube</strong> run. The <code>data</code> folder itself is made of subfolders of arbitrary name (not limited to 5 characters) that contains a series of data files. Only one of these sub-directories can be accessed/read in any given <strong>Pecube</strong> run/inversion and is specified by the <code>data_folder</code> parameter in the input file <code>Pecube.in</code>. The reason for creating this layer of subfolders is to allow the user to use different datasets or different combinaisons of datasets to perform different inversions using <strong>Pecube</strong>.</p>
</div>
<div class="paragraph">
<p>For example, the user has performed an inversion using all the data from a series of files stored in the <code>data/dataset1</code> sub-folder. The user may wish to see how important a set Apatite Helium ages is in constraining the result of an inversion. For this the user creates a new subdirectory called <code>data/dataset2</code> in which all files from the <code>data/dataset1</code> sub-directory have been copied, EXCEPT for the file(s) containing the Apatite Helium ages. The user can then perform a new <strong>Pecube</strong> run or inversion by specifying <code>data_folder = dataset2</code> in the <code>Pecube.in</code> input file.</p>
</div>
<div class="paragraph">
<p>After <strong>Pecube</strong> is run, the project folder will contain an <code>output</code> folder in which the <strong>Pecube</strong> outputs are stored as <code>.csv</code> files and <code>.out</code> or binary files. The <code>.csv</code> files can be opened in Excel or Numbers or any other data analysis software for processing. They include: the ages at all points of the topographic grid for each of the thermochronological systems (or as requested), the comparison between the data/observations and the <strong>Pecube</strong> predictions (if data has been provided to <strong>Pecube</strong>), time-temperature paths (if requested) and volume eroded (if requested). The <code>.out</code> files are binary files that are used to produce the <code>VTK</code> files stored in the <code>VTK</code> folder (see below). The content of all output files is described in the section <a href="#Output">[Output]</a></p>
</div>
<div class="paragraph">
<p>Other folders created at <strong>Pecube</strong> run time include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <code>VTK</code> folder that contains the <code>.vtk</code> files created by <strong>Pecube</strong></p>
</li>
<li>
<p>a <code>NA</code> folder that contains the results of any <strong>Pecube</strong> inversion as <code>.csv</code> and <code>.nad</code> files</p>
</li>
<li>
<p>a <code>LOG</code> folder that contains a log file in case the user has turned on the <code>debug</code> option in the <code>Pecube.in</code> input file</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>At run time, <strong>Pecube</strong> will create all the folders (if they do not exist yet) inside the <code>project</code> folder, but obviously not the input folder which must already exists as it contains the main input file <code>Pecube.in</code></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_topo">topo</h3>
<div class="paragraph">
<p>The <code>topo</code> folder contains a single file called <code>Topo30</code> that contains a 30 sec resolution DEM of the world. See section <a href="#topo_file_name">[topo_file_name]</a> for further details on its content and its use/purpose.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_main_input_file">Main input file</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Pecube</strong> input file <code>Pecube.in</code> contains all the directives and model parameter values needed for <strong>Pecube</strong> to perform a run, including the name of the topographic file (or DEM) and the name of the data folder where the data/observations to model are stored. it is stored in the <code>$RUN/input</code> directory/folder.</p>
</div>
<div class="sect2">
<h3 id="_topography_parameters"><a id="TOPOGRAPHY"></a>Topography parameters</h3>
<div id="topo_file_name" class="dlist">
<dl>
<dt class="hdlist1"><code>topo_file_name</code> <em>(default = <code>Nil</code>)</em></dt>
<dd>
<p>Name of the file containing the topography as a grid of elevation points.
The file should be in the <code>$RUN/data</code> directory and contain a single column of real numbers giving the elevation of the topography in meters, starting from the bottom left corner, ending at the top right corner, and spanning the area of interest (defined by <code>lat0, lon0, nx, ny, dlon, dlat</code>) in row-major order. <span class="image right"><img src="images/Grid.jpg" alt="Topographic file ordering" width="250" height="150"></span></p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>If <code>topo_file_name</code> is given the value <code>Nil</code>, the topography is assumed to be flat at elevation 0.</p>
</li>
<li>
<p>If <code>topo_file_name</code> is given the value <code>Topo30</code>, the topography is automatically extracted from the global elevation database GTOPO30 (<code><a href="https://dds.cr.usgs.gov/srtm/version2_1/SRTM30/srtm30_documentation.pdf" class="bare">https://dds.cr.usgs.gov/srtm/version2_1/SRTM30/srtm30_documentation.pdf</a></code>). This option requires that you download the 1.8 GB file: <code><a href="ftp://topex.ucsd.edu/pub/srtm30_plus/topo30/" class="bare">ftp://topex.ucsd.edu/pub/srtm30_plus/topo30/</a></code>.</p>
</li>
<li>
<p>if <code>topo_file_name</code> ends with a slash '/', it will be assumed to be a directory in which there is a collection of files containing the topography, <code>topo0</code> to <code>topon</code>, the uplift rate, <code>uplift0</code> to <code>upliftn</code>, and the surface temperature, <code>temp0</code> to <code>tempn</code>. The number of steps needed are set by <code>ntime</code>, i.e. <code>n = ntime + 1</code></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>nx</code> <em>(default = <code>31</code>)</em></dt>
<dd>
<p>Number of points describing the topography in the x-(or longitude-)direction</p>
</dd>
</dl>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>nx</code> can only take integer values. The value you attribute to it MUST be an integer. Do not use <code>nx = 25.0</code> or even <code>nx = 25.</code> This will cause <strong>Pecube</strong> to crash. Note that this warning applies to all paameters that can only take integer values. To make sure that this problem does not affect you, a good habit is to avoid using a decimal point at the end of numbers if you don&#8217;t need it.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ny</code> <em>(default = <code>31</code>)</em></dt>
<dd>
<p>Number of points describing the topography in the y-(or latitude-)direction</p>
</dd>
<dt class="hdlist1"><code>lon0</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Longitude of the bottom left corner of the topographic data/file/grid(s)</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Longitudes are expressed in decimal degree; longitudes East of Greenwich meridian are positive; longitudes West of Greenwich are negative meridian</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>lat0</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Latitude of the bottom left corner of the topographic data/file/grid(s)</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Latitudes are expressed in decimal degree; longitudes North of Equator are positive; longitudes South of Equator are negative</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>dlon</code> <em>(default = <code>0.0083333</code>)</em></dt>
<dd>
<p>Distance in decimal degrees between two points on the topographic grid in the longitude direction</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>dlon</code> and <code>dlat</code> must be positive and strictly greater than 0</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>dlat</code> <em>(default = <code>0.0083333</code>)</em></dt>
<dd>
<p>Distance in decimal degrees between two points on the topographic grid in the latitude direction</p>
</dd>
<dt class="hdlist1"><code>nskip</code> <em>(default = <code>1</code>)</em></dt>
<dd>
<p>Stride used to read the topo_input_file. When <code>nskip=1</code>, all points of the <code>topo_input_file</code> are used, otherwise every <code>nskip</code> point only is used, in both the x- and y-directions</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_time_evolution_parameters">Time evolution parameters</h3>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ntime</code> <em>(default = <code>1</code>)</em></dt>
<dd>
<p>Number of time steps needed to describe the scenario for the evolution of the topography. For each time step, you will need to provide an amplification factor, <code>amplification<sub><em>i</em></sub></code>, an offset factor, <code>offset<sub><em>i</em></sub></code>, as well as an output flag value, <code>output<sub><em>i</em></sub></code>. At step <code><strong><em>i</em></strong></code>, the topography used in <strong>Pecube</strong>, <code>h<sub><em>i</em></sub></code>, is obtained by the following scaling of the topography, <code>h<sub><em>0</em></sub></code>, in the input file: <code>h<sub><em>i</em></sub> = offset<sub><em>i</em></sub> + amplification<sub><em>i</em></sub> x h<sub><em>0</em></sub></code></p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There is an implied time step corresponding to present-day, for which the amplification factor <code>amplification<sub><em>ntime+1</em></sub></code> is 1, the offset <code>offset<sub><em>ntime+1</em></sub></code> is 0 and the output flag, <code>offset<sub><em>ntime+1</em></sub></code> is 1. <code>ntime</code> should therefore be regarded as the number of intervals used to describe the topographic scenario, and the <code>time_topo<strong><em>i</em></strong></code> values the times at which each interval starts.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>time_topo<strong><em>i</em></strong></code> (no default values)</dt>
<dd>
<p>Time expressed in million years in the past at which topography is set to <code>h<sub><em>i</em></sub> = offset<sub><em>i</em></sub> + amplification<sub><em>i</em></sub> x  h<sub><em>0</em></sub></code>.</p>
</dd>
</dl>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Because <strong>Pecube</strong> uses geological time, the various <code>time_topo<strong><em>i</em></strong></code> must monotonously decrease with <code><strong><em>i</em></strong></code> such that: <code>time_topo<strong><em>i</em></strong> &gt; time_topo<strong><em>i+1</em></strong></code></p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>amplification<strong><em>i</em></strong></code> <em>(default = <code>1</code>)</em></dt>
<dd>
<p>Topographic amplification factor used at time <code><strong><em>i</em></strong></code></p>
</dd>
<dt class="hdlist1"><code>offset<strong><em>i</em></strong></code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Topographic offset factor used at time <code><strong><em>i</em></strong></code></p>
</dd>
<dt class="hdlist1"><code>output<strong><em>i</em></strong></code> <em>(default = <code>1</code>)</em></dt>
<dd>
<p>Output flag used at time <code><strong><em>i</em></strong></code>. If <code>output<strong><em>i</em></strong> = 1</code>, <strong>Pecube</strong> will compute and output thermochronological ages at time <code><strong><em>i</em></strong></code>. If <code>output<strong><em>i</em></strong> = 0</code>, <strong>Pecube</strong> will not compute nor will it output ages at time <code><strong><em>i</em></strong></code></p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Setting the output flag <code>output<strong><em>i</em></strong> = 1</code> at a time <code><strong><em>i</em></strong></code> that is not equal to <code>ntime + 1</code> will generate ages that can be compared to detrital ages or detrital age distributions as well as &#8220;maps&#8221; of ages, as requested. This means that the ages are given as ages with respect to present-day, not with respect to <code>time_topo<strong><em>i</em></strong></code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>erosional_time_scale</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Time scale (in Myr) that determines how the topography is interpolated between two time steps, i.e. during a given time interval. If the time scale is nil, the interpolation is linear; if the time scale is large and positive, the interpolation corresponds to a decelerating change throughout the time interval (the most likely &#8220;geomorphic&#8221; scenario for an eroding topography); if the time scale is large and negative, the interpolation corresponds to an accelerating change throughout the time interval. <span class="image right"><img src="images/Tau.jpg" alt="Erosional time scale" width="450" height="300"></span></p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The formula used in <strong>Pecube</strong> to interpolate topography during a time step is:<br>
<code>h(t) = h1 + (h2 - h1)*(1 - exp(-f(t)*dt/tau))/(1 - exp(dt/tau))</code><br>
where <code>h1</code> and <code>h2</code> are the initial and final topography over the time interval <code>dt</code> and<br>
<code>f(t) = (t - t1)/(t2 - t1)</code><br>
Note that if <code>tau = 0</code>, this formula shortens to: <code>h(t) = h1 + (h2 - h1)*f(t)</code></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_thermal_parameters">Thermal parameters</h3>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>thickness</code> <em>(default = <code>35</code>)</em></dt>
<dd>
<p>Assumed crustal thickness (in km). This is the depth of the bottom of the crustal layer being modeled. The temperature at the base of the model (depth = <code>thickness</code>) is assumed to be fixed at a value set by <code>basal_temperature</code></p>
</dd>
<dt class="hdlist1"><code>basal_temperature</code> <em>(default = <code>700</code>)</em></dt>
<dd>
<p>Temperature (in &#176;C) imposed at the base of the model, i.e. at a depth specified by <code>thickness</code>.</p>
</dd>
<dt class="hdlist1"><code>nz</code> <em>(default = <code>21</code>)</em></dt>
<dd>
<p>Number of points used to discretize the crust in the z-direction</p>
</dd>
<dt class="hdlist1"><code>sea_level_temperature</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Temperature (in &#176;C) at sea level (zero topography).</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The surface boundary condition in <strong>Pecube</strong> assumes that the temperature can vary as a function of elevation. The formula for <code>T(h)</code> used in <strong>Pecube</strong> is:<br>
<code>T(h) = T(0) + LR h</code><br>
where <code>T(0)</code> is the temperature at zero elevation (<code>sea_level_temperature</code>) and <code>LR</code> is the lapse rate ('lapse_rate') or rate of change of temperature with elevation.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>lapse_rate</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Rate of change of temperature with elevation in the atmosphere (in &#176;C/km).</p>
</dd>
<dt class="hdlist1"><code>thermal_diffusivity</code> <em>(default = <code>25</code>)</em></dt>
<dd>
<p>Thermal diffusivity, <code>kappa</code>, used in <strong>Pecube</strong> to solve the heat transport equation in 3D:<br>
<code>T<sub><em>t</em></sub> + vx T<sub><em>x</em></sub> + vy T<sub><em>y</em></sub> + vz <sub><em>z</em></sub> = kappa (T<sub><em>xx</em></sub> + T<sub><em>yy</em></sub> + T<sub><em>zz</em></sub>) + H</code><br>
The thermal diffusivity is in km<sup>2</sup>/Myr. If it is given as a negative number, a subroutine called <code>thermal_diffusivity</code> must be supplied by the user to describe the spatial variation of the diffusivity at the onset of calculations, and its potential variation with time and temperature. The following &#8220;empty&#8221; subroutine is provided with the <strong>Pecube</strong> distribution.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>double precision thermal_diffusivity (x0,y0,z0,temp,time)

implicit none

double precision x0,y0,z0,temp,time

thermal_diffusivity=25.d0

return
end</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>heat_production</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Heat production used to solve the heat transport equation (in &#176;C/Myr). If it is given as a negative number, a subroutine called <code>heat_production</code> must be supplied by the user to describe the spatial variation of the heat production at the onset of calculations, and its potential variation with time and temperature. The following &#8220;empty&#8221; subroutine is provided with the <strong>Pecube</strong> distribution.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>double precision function heat_production (x0,y0,z0,temp,time)

implicit none

double precision x0,y0,z0,temp,time

heat_production=3.d0

return
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_data_parameters">Data parameters</h3>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>data_folder</code> <em>(default = <code>Nil</code>)</em></dt>
<dd>
<p>Name of a folder stored in the <code>data/</code> directory that contains all the data/observations that the use wishes to pass to <strong>Pecube</strong>, either for comparison with <strong>Pecube</strong>'s predictions or for inversion purposes. The content of the <code>.csv</code> files contained in the <code>data_folder</code> is described in the section <a href="#Feeding_data_to_<strong>Pecube</strong>">Feeding data to <strong>Pecube</strong></a>.</p>
</dd>
<dt class="hdlist1"><code>default_age</code> <em>(default = <code>time_topo1</code>)</em></dt>
<dd>
<p>Default age (in Myr) given to rock particles that have not been reset, i.e. that have not reached the &#8220;closure temperature&#8221; for the system considered.</p>
</dd>
<dt class="hdlist1"><code>FT_code_flag</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag used to define which of the two fission track annealing routine to use to predict fission track ages and fission track length distributions. If <code>FT_code_flag = 0</code> Peter van der Beek&#8217;s routine is used; if <code>FT_code_flag = 1</code> Richard Ketcham&#8217;s routine is used.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_tectonic_parameters">Tectonic parameters</h3>
<div class="paragraph">
<p>Tectonic forcing is introduced in <strong>Pecube</strong> by setting a velocity field (relative to the base of the model that is assumed to remain fixed) or rock uplift/transport velocity that is then used in the heat transport equation. <strong>Pecube</strong> allows for two type of tectonic forcings: a &#8220;uniform&#8221; uplift, i.e. that can only vary as a bi-linear function of horizontal coordinates, and a velocity field corresponding to faults of a given geometry. The faults are planar and tri-dimensional but must all have the same strike (i.e. orientation of their ssurface expression). To define a fault, the use must specify the direction of that strike, as well as the width of the faults, by giving the lat-lon coordinates of two points, <code>X1</code> and <code>X2</code>. The geometry of these two points is shown in the following figure. <span class="image right"><img src="images/coordinatesystem.jpg" alt="Geomerty of faults" width="250" height="150"></span></p>
</div>
<div class="paragraph">
<p>The vertical geometry of the faults is then specified by a number of <code>(r,s)</code> points that define segments of the faults. <code>r</code> is the horizontal coordinate perpendicular to the line defined by the two points <code>X1</code> and <code>X2</code>. <code>s</code> is the vertical coordinate (positive above the top surface, <code>z = 0</code>). Note that the direction of <code>r</code> is to the right of the line defined by going from <code>X1</code> to <code>X2</code>.</p>
</div>
<div class="paragraph">
<p>Velocities are then calculated by assuming that the velocity vector parallel to each of the successive fault segments. In regions where two segments of the fault can be used to define the velocity, the average is used. This ensures mass conservation across fault segments.  <span class="image right"><img src="images/segments.jpg" alt="Velocity field" width="250" height="400"></span></p>
</div>
<div class="paragraph">
<p>The amplitude of the velocity can change through time for each fault. It is specified through a termporal history made of time intervls and velocity magnitude. The velocity amplitude provided by the user is the horizontal convergence velocity (or divergence velocity). If the velocity is positive, the fault is asumed to be normal; if the velocity is negative the fault is assumed to be a thrust.</p>
</div>
<div class="paragraph">
<p>Note that the order in which the <code>(r,s)</code> points are given is important: it determines on which side of the fault the velocity is calculated/applied. The rule is that the velocity is applied on the right-hand side of the fault (going from the first to the last point defining the segments of the fault). The two options are illustrated in the following figure for a thrust fault (negative velocity amplitude).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/velo.jpg" alt="Velocity field" width="500" height="400">
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>nfault</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Number of faults used to describe the velocity field.</p>
</dd>
</dl>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the user wishes to specify a uniform uplift and no fault, <code>nfault</code> must still be set to 1. <code>nfault = 0</code> implies no tectonic forcing/uplift and <strong>Pecube</strong> will compute the thermal effect of topographic change only.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>lon1</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Longitude (in decimal degrees) of <code>X1</code>, the first of two points used to define the faults strike and width.</p>
</dd>
<dt class="hdlist1"><code>lat1</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Latitude (in decimal degrees) of <code>X1</code>, the first of two points used to define the faults strike and width.</p>
</dd>
<dt class="hdlist1"><code>lon2</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Longitude (in decimal degrees) of <code>X2</code>, the second of two points used to define the faults strike and width.</p>
</dd>
<dt class="hdlist1"><code>lat2</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Latitude (in decimal degrees) of <code>X2</code>, the second of two points used to define the faults strike and width.</p>
</dd>
<dt class="hdlist1"><code>npoint<strong><em>i</em></strong></code> (no default value)</dt>
<dd>
<p>Number of points used to define the fault segments in the vertical direction for fault <code><strong><em>i</em></strong></code>.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that if the user wishes to use a uniform uplift function, it must specify a single fault (<code>nfault = 1</code>) for which the number of points is negative (<code>npoints<strong><em>1</em></strong> = -1</code>).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The fault segment geometry (the <code>r</code> and <code>s</code> coordinates) as well as a velocity history MUST BE PROVIDED FOR EACH OF THE FAULTS.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>r<strong><em>i</em></strong>_<strong><em>j</em></strong></code> (no default value)</dt>
<dd>
<p>Horizontal coordinate of point <strong><em>j</em></strong> of fault <strong><em>i</em></strong> (in km) used to define the fault <strong><em>i</em></strong> geometry.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>Note, as indicated above, that the order in which the coordinates are numbered ( from <strong><em>1</em></strong> to npoint<strong><em>i</em></strong>) is important as it defines in which of the two half-spaces (above or below the fault) the velocity is computed/set.</p>
</li>
<li>
<p>If the user wishes to impose motion on either sides of the fault (overthrusting on top and underthrusting below, for example), two faults must be defined, with identical geometries but with the points defining the segments in reversed orders.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>s<strong><em>i</em></strong>_<strong><em>j</em></strong></code> (no default value)</dt>
<dd>
<p>Vertical coordinate of point <strong><em>j</em></strong> of fault <strong><em>i</em></strong> (in km) used to define the fault <strong><em>i</em></strong> geometry. Positive values correspond to positive elevation, negative values correspond to depth.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Setting an <code>r</code> or <code>s</code> coordinate value to a star value * implies that the the corresponding <code>r</code> or <code>s</code> value is equal to the previous <code>r</code> or <code>s</code> values, respecitvely.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>bottom_left</code> <em>(default = <code>1</code>)</em></dt>
<dd>
<p>Uplift velocity (in km/Myr) imposed across the entire depth range at the bottom left corner of the <strong>Pecube</strong> domain (minimum longitude and minimum latitude). This parameter as well as <code>bottom_right</code>, <code>upper_right</code> and <code>upper_left</code>, are needed when defining a uniform uplift velocity (<code>nfault = 1</code> and <code>npoints<strong><em>1</em></strong> = -1</code>). These four values are then used to compute a velocity field by bi-linear interpolation.</p>
</dd>
<dt class="hdlist1"><code>bottom_right</code> <em>(default = <code>1</code>)</em></dt>
<dd>
<p>Uplift velocity (in km/Myr) imposed across the entire depth range at the bottom right corner of the <strong>Pecube</strong> domain (maximum longitude and minimum latitude).</p>
</dd>
<dt class="hdlist1"><code>top_right</code> <em>(default = <code>1</code>)</em></dt>
<dd>
<p>Uplift velocity (in km/Myr) imposed across the entire depth range at the upper right corner of the <strong>Pecube</strong> domain (maximum longitude and maximum latitude).</p>
</dd>
<dt class="hdlist1"><code>top_left</code> <em>(default = <code>1</code>)</em></dt>
<dd>
<p>Uplift velocity (in km/Myr) imposed across the entire depth range at the upper left corner of the <strong>Pecube</strong> domain (minimum longitude and maximum latitude).</p>
</dd>
<dt class="hdlist1"><code>nstep<strong><em>i</em></strong></code> (no default value)</dt>
<dd>
<p>Number of time intervals needed to define the velocity history for fault <strong><em>i</em></strong>.</p>
</dd>
<dt class="hdlist1"><code>time_start<strong><em>i</em></strong>_<strong><em>j</em></strong></code> (no default value)</dt>
<dd>
<p>Begining of time interval <strong><em>j</em></strong> (in Myr and geological time) for fault <strong><em>i</em></strong>.</p>
</dd>
</dl>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Because <strong>Pecube</strong> use geological time, the start time must be greater than the end time.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>time_end<strong><em>i</em></strong>_<strong><em>j</em></strong></code> (no default value)</dt>
<dd>
<p>End of time interval <strong><em>j</em></strong> (in Myr and geological time) for fault <strong><em>i</em></strong>.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Setting a <code>time_start</code> to a star value * implies that the <code>time_start</code> for the corresponding interval is equal to the <code>time_end</code> of the previous interval, i.e. <code>time_start<strong><em>i</em></strong>_<strong><em>j</em></strong> = time_end<strong><em>i</em><em>_j-1</em></strong></code></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>One can also force a time value (either <code>time_start</code> or <code>time_end</code>) to be equal to one of the times defining the topographic evolution, i.e., <code>time_start<em>1</em><em>_1</em><strong> = time_topo</strong><em>1</em><strong></code> or <code>time_end<em>1</em><em>_1</em></strong> = time_topo<strong><em>2</em></strong></code></p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>velo<strong><em>i</em></strong>_<strong><em>j</em></strong></code> (no default value)</dt>
<dd>
<p>Velocity amplitude (in km/Myr) for time interval <strong><em>j</em></strong> for fault <strong><em>i</em></strong>.</p>
</dd>
<dt class="hdlist1"><code>static<strong><em>i</em></strong></code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag used to inhibit the contribution from fault <strong><em>i</em></strong> to the computed velocity field; when this flag is set to 1 the fault is only used to advect the other faults, it does not contribute to the velocity field used to compute the advection term in <strong>Pecube</strong>.</p>
</dd>
<dt class="hdlist1"><code>logarithmic_velocity</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag used to specify whether velocities are given as logarithmic values (if set to 1) (this is potentially useful for inversion purposes). See section <a href="#Inversion">[Inversion]</a> for more details about <strong>Pecube</strong> inversion mode.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_output_parameters"><a id="OUTPUTPARAMS"></a> Output parameters</h3>
<div class="paragraph">
<p><strong>Pecube</strong> outputs the results of the computations in a variety of formats and files. A full descrition of the output from <strong>Pecube</strong> is given in section <a href="#Output">[Output]</a>. One of these outputs is the computed ages at all points of the surface/topographic grid. The number of these points can be quite large (10,0000 or more) and computation of all ages (i.e. for all thermochronometric systems) will take some time. The user might not be interested in all different types of ages; therefore options exists to restrict the number of thermochronologis systems being computed by <strong>Pecube</strong>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>age_TL_flag</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag to impose the computation of Thermoluminescence ages (=1) at all points of the surface/topographic grid or to prevent it (1).</p>
</dd>
<dt class="hdlist1"><code>age_OSL_flag</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag to impose the computation of Optical Luminescence ages (=1) at all points of the surface/topographic grid or to prevent it (1).</p>
</dd>
<dt class="hdlist1"><code>TL_doser</code> <em>(default = <code>5</code>)</em></dt>
<dd>
<p>Dose rate used for TL/OSL data computation (in Gy/s/ka)</p>
</dd>
<dt class="hdlist1"><code>TL_D0</code> <em>(default = <code>800</code>)</em></dt>
<dd>
<p>Onset of dose saturation for TL/OSL data computation (in Gy)</p>
</dd>
<dt class="hdlist1"><code>TL_a</code> <em>(default = <code>1.8</code>)</em></dt>
<dd>
<p>Kinetic orders of trapping for TL/OSL data computation</p>
</dd>
<dt class="hdlist1"><code>TL_b</code> <em>(default = <code>1.8</code>)</em></dt>
<dd>
<p>Kinetic orders of detrapping for TL/OSL data computation</p>
</dd>
<dt class="hdlist1"><code>TL_Et</code> <em>(default = 1.4)</em></dt>
<dd>
<p>Activation energy for TL/OSL data computation (in eV)</p>
</dd>
<dt class="hdlist1"><code>TL_logs</code> <em>(default = 12)</em></dt>
<dd>
<p>Logarithm of thermal frequency factor for TL/OSL data computation (in 1/s)</p>
</dd>
<dt class="hdlist1"><code>TL_logrho</code> <em>(default = -5.5)</em></dt>
<dd>
<p>Logarithm of dimensionless recombination center density for TL/OSL data computation</p>
</dd>
<dt class="hdlist1"><code>age_AHe_flag</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag to impose the computation of Helium ages in Apatite (=1) at all points of the surface/topographic grid or to prevent it (1).</p>
</dd>
<dt class="hdlist1"><code>age_ZHe_flag</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag to impose the computation of Helium ages in Zircon (=1) at all points of the surface/topographic grid or to prevent it (1).</p>
</dd>
<dt class="hdlist1"><code>age_AFT_flag</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag to impose the computation of fission track ages in Apatite (=1) at all points of the surface/topographic grid or to prevent it (1).</p>
</dd>
<dt class="hdlist1"><code>age_ZFT_flag</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag to impose the computation of fission track ages in Zircon (=1) at all points of the surface/topographic grid or to prevent it (1).</p>
</dd>
<dt class="hdlist1"><code>age_FTL_flag</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag to impose the computation of mean fission track length in Apatite (=1) at all points of the surface/topographic grid or to prevent it (1).</p>
</dd>
<dt class="hdlist1"><code>age_KAr_flag</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag to impose the computation of Argon ages in K-Feldspar (=1) at all points of the surface/topographic grid or to prevent it (1).</p>
</dd>
<dt class="hdlist1"><code>age_BAr_flag</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag to impose the computation of Argon ages in Biotite (=1) at all points of the surface/topographic grid or to prevent it (1).</p>
</dd>
<dt class="hdlist1"><code>age_MAr_flag</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag to impose the computation of Argon ages in Muscovite (=1) at all points of the surface/topographic grid or to prevent it (1).</p>
</dd>
<dt class="hdlist1"><code>age_HAr_flag</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag to impose the computation of Argon ages in Hornblende (=1) at all points of the surface/topographic grid or to prevent it (1).</p>
</dd>
<dt class="hdlist1"><code>debug</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag to impose debuging information to be sent to a log file (if set to 1)</p>
</dd>
</dl>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This option for advanced users or developers only.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>save_PTT_paths</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag to force the saving to <code>.csv</code> files of the thermal histories of points where observations have been provided (if set to 1).</p>
</dd>
<dt class="hdlist1"><code>save_eroded_volume</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag to force the saving to a <code>.csv</code> file of the eroded volume through time (if set to 1)</p>
</dd>
<dt class="hdlist1"><code>echo_input_file</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag to echo the content of the <code>Pecube.in</code> file. Four values are accepted:</p>
<div class="ulist">
<ul>
<li>
<p>0: no echo</p>
</li>
<li>
<p>1: echo the name of the parameter and its value read in the input file</p>
</li>
<li>
<p>2: echo the name of the parameter and both its value read in the input file and its default value</p>
</li>
<li>
<p>3: echo the name of the parameter, its value read in the input file and its default value, and a short description</p>
</li>
<li>
<p>4: echo a short description of all parameters that can be specified in the input file (this option interrupts the execution of <strong>Pecube</strong>)</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_isostasy_parameters">Isostasy parameters</h3>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>isostasy</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag used to trigger flexural isostatic adjustment to <strong>Pecube</strong>. If <code>isostasy = 0</code>, no isostatic calculations are done; if <code>isostasy = 1</code> isostatic calculations are performed at every time step.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Pecube</strong> solves the equation governing the deflection of a 2D thin elastic plate floating on an inviscid asthenosphere:<br>
<code>D w<sub><em>xxxx</em></sub> + D w<sub><em>xxyy</em></sub> + D w<sub><em>yyyy</em></sub> + (rhoa - rhoc) g w = rhoc g dh</code><br>
where <code>w</code> is the isostatic surface deflection, <code>x</code> and <code>y</code> are the spatial coordinates, <code>rhoa</code> and <code>rhoc</code> are the density of asthenospheric and crustal rocks, respectively, <code>g</code> is gravitational acceleration, <code>dh</code> is the amount of material begin eroded and or deposited, and <code>D</code> is the flexural parameter given by:<br>
<code>D = Y EET<sup><em>3</em></sup> / 12(1 - pr<sup><em>2</em></sup>)</code><br>
where <code>Y</code> is Young&#8217;s moduls, <code>EET</code> effective elastic plate thickness and <code>pr</code> Poisson&#8217;s ratio. <strong>Pecube</strong> uses an FFT (Fast Fourier Transform) method as described in Nunnes and (Nunn and Aires, 1988).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The load <code>rhoc g dh</code> is computed from the amount removed/added to the surface topography between two time steps and is used to compute an incremental deflection over the time step. This deflection is then used to adjust the erosion or exhumation rate (i.e. vertical velocity with respect to the base of the model) at every point of the model. It DOES NOT affect the topography that is arbitrarily specified by the user.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>EET</code> <em>(default = <code>20</code>)</em></dt>
<dd>
<p>Effective Elastic Thickness (in km) used to compute the isostatic deflection.</p>
</dd>
<dt class="hdlist1"><code>rho_crust</code> <em>(default = <code>2400</code>)</em></dt>
<dd>
<p>Crustal density (in kg/m<sup>3</sup>) used to compute the isostatic deflection.</p>
</dd>
<dt class="hdlist1"><code>rho_asthenosphere</code> <em>(default = <code>3150</code>)</em></dt>
<dd>
<p>Asthenospheric density (in kg/m<sup>3</sup>) used to compute the isostatic deflection.</p>
</dd>
<dt class="hdlist1"><code>young_modulus</code> <em>(default = <code>1e11</code>)</em></dt>
<dd>
<p>Young Modulus (in Pa) used to compute the isostatic deflection.</p>
</dd>
<dt class="hdlist1"><code>poisson_ratio</code> <em>(default = <code>0.25</code>)</em></dt>
<dd>
<p>Poisson&#8217;s ratio (unitless) used to compute the isostatic deflection.</p>
</dd>
<dt class="hdlist1"><code>nx_isostasy</code> <em>(default = <code>1024</code>)</em></dt>
<dd>
<p>resolution of the FFT grid (in the x-direction) used to solve the flexure equation. It must be a power of 2.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Pecube</strong> first interpolates the load (derived from the increment in topography over the time step) onto a regular mesh of resolution <code>nx_isostasy x ny_isostasy</code> on which the deflection is computed by FFT. This is why <code>nx_isostasy</code> and <code>ny_isostasy</code> must be powers of 2. The deflection is then interpolated back on the <strong>Pecube</strong> mesh of resolution <code>nx x ny</code> (with stride <code>nskip</code>).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ny_isostasy</code> <em>(default = <code>1024</code>)</em></dt>
<dd>
<p>resolution of the FFT grid (in the x-direction) used to solve the flexure equation. It must be a power of 2.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="Inversion_parameters">Inversion parameters</h3>
<div class="paragraph">
<p><strong>Pecube</strong> can be used in <em>Inversion</em> mode to explore/find the value of seleceted parameters that produce ages that best fit observations/data provided by the user. The <em>Inversion</em> mode is explained in section <a href="#Inversion">[Inversion]</a> and makes use of the Neighbourhood Algorithm (NA). A few flags can be set to control/alter the behaviour of the Neighbourhood algorithm.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>maximum_number_of_iterations</code> <em>(default = <code>4</code>)</em></dt>
<dd>
<p>Total number of NA iterations to be performed (not including the first one).</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>NA explores the parameter space by randomly generating sets of model parameters (one set per forward model run of <strong>Pecube</strong>). It performs this task a set number of times (or iterations) given by the parameter <code>maximum_number_of_iterations</code>. At the end of each iteration, NA constructs the Voronoi diagram around the points in parameter space that correspond to each model run (and set of parameters) performed during previous iterations. It will then select a finite number (<code>number_of_cells_to_resample</code>) of the best Voronoi cells (those that are charcterized by a small misfit function value) to resample in the next iteration. It will perform model runs (<code>sample_size_for_all_other_iterations</code> of them) by selecting model parameter sets that are contained in those Voronoi cells only. During the first iteration NA performs a set number of model runs (given by the parameter <code>sample_size_for_first_iteration</code>) corresponding to sets of parameters uniformly distributed in the entire parameter space.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>sample_size_for_first_iteration</code> <em>(default = <code>8</code>)</em></dt>
<dd>
<p>Number of model runs (and model parameter sets) performed during the first, initial iteration.</p>
</dd>
<dt class="hdlist1"><code>sample_size_for_all_other_iterations</code> <em>(default = <code>8</code>)</em></dt>
<dd>
<p>Number of model runs (and model parameter sets) performed during every subsequent iteration.</p>
</dd>
<dt class="hdlist1"><code>number_of_cells_to_resample</code> <em>(default = <code>4</code>)</em></dt>
<dd>
<p>Number of Voronoi cells that will be resampled uniformly during any given iteration (except the first one). Those Voronoi cells are selected to be those that are charcaterized by the smallest misfit values..</p>
</dd>
<dt class="hdlist1"><code>misfit_weight_AGE</code> <em>(default = <code>1</code>)</em></dt>
<dd>
<p>Factor or weight (dimensionless) multiplying the part of the misfit function that measures the difference between observed and predicted ages.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Neighbourhood Algorithm explores parameter space to minimize a misfit function that measures the difference between observations and predictions. This function is made up of various components that are added to each other and correspond to different types of data/observations. The user can alter how these different types of data are combined by specifying weights or factors. These are <code>misfit_weight_age</code>, <code>misfit_weight_FTLD</code>, <code>misfit_weight_TH</code>, <code>misfit_weight_43He</code>, <code>misfit_weight_TL</code> and <code>misfit_slope</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>misfit_weight_FTLD</code> <em>(default = <code>1</code>)</em></dt>
<dd>
<p>Factor or weight (dimensionless) multiplying the part of the misfit function that measures the difference between observed and predicted fission track length distributions.</p>
</dd>
<dt class="hdlist1"><code>misfit_weight_TH</code> <em>(default = <code>1</code>)</em></dt>
<dd>
<p>Factor or weight (dimensionless) multiplying the part of the misfit function that measures the difference between observed and predicted thermal histories.</p>
</dd>
<dt class="hdlist1"><code>misfit_weight_43He</code> <em>(default = <code>1</code>)</em></dt>
<dd>
<p>Factor or weight (dimensionless) multiplying the part of the misfit function that measures the difference between observed and predicted <sup>43</sup>Helium ages.</p>
</dd>
<dt class="hdlist1"><code>misfit_weight_TL</code> <em>(default = <code>1</code>)</em></dt>
<dd>
<p>Factor or weight (dimensionless) multiplying the part of the misfit function that measures the difference between observed and predicted Thermoluminescence data.</p>
</dd>
<dt class="hdlist1"><code>misfit_slope</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag to set whether the ages themselves are to be used to define the age part of the misfit function (<code>misfit_slope=0</code>) or if the slope and intercept of the age-elevation relationship derived form the predictions and observations are to be used (<code>misfit_slope=1</code>).</p>
</dd>
</dl>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that the age elevation relationship used for the misfit function is computed for all the points for which an age is provided.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>misfit_corrected</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag to correct the misfit function by the number of observations minus the number of parameters + 1 (if <code>misfit_corrected=1</code>)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_miscellaneous_flags">Miscellaneous flags</h3>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>fault_advect_flag</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Flag to set whether the motion on any given fault can affect the geometry/position of the other faults (<code>fault_advect_flag = 1</code>) or not (<code>fault_advect_flag = 0</code>).</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In theory, this flag should be set to 1. However, in practice, this requires that the faults be each defined by a large number of segments/points as the fault geometry is updated by updating the position of the points defining the segments. If a fault is defined by only a few points, once these points are advected the fault geometry resulting from connecting these points by line segments can be very &#8220;strange&#8221;. In general, we do not recommend that the user sets this flag to 1.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>shear_heating</code> <em>(default = <code>0</code>)</em></dt>
<dd>
<p>Friction coefficient used to multiply an arbitrary stress value of 100 Mpa to compute the heat produced by friction; the heat is calculated as the product of strain rate, stress, and the friction coefficient, divided by the specific heat capacity (taken here to be 800 J/&#176;C/kg). The strain rate is directly computed from the velocity field.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To change the value of the assumed stress and/or heat capacity, the user should simply modify the value of the friction coefficient accordingly, as all factors are multiplied.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_output"><a id="Output"></a>Output</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_types_and_formats">Types and formats</h3>
<div class="paragraph">
<p><strong>Pecube</strong> produces several types of output. They include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ages computed at the nodes of the topographic grid</p>
</li>
<li>
<p>ages and T-t paths computed at the observation points (i.e. where data was provided)</p>
</li>
<li>
<p>The temperature field inside the crust</p>
</li>
<li>
<p>echoes of the model setup, such as the topography through time, the geometry of the faults and the exhumation velocity field</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These outputs are stored under verious formats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>as <code>.csv</code> or comma-separated-values files stored in the <code>output</code> folder of the current $RUN</p>
</li>
<li>
<p>as <code>.vtk</code> or virtual tool kit files stored in the <code>VTK</code> folder of the current $RUN</p>
</li>
<li>
<p>as <code>.out</code> or binary files stored in the <code>output</code> folder of the current $RUN</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_csv_files">CSV files</h3>
<div class="sect3">
<h4 id="_ages_files">Ages files</h4>
<div class="paragraph">
<p>The main purpose of <strong>Pecube</strong> is to compute ages from a given tectonomorphic scenario. <strong>Pecube</strong> therefore computes the ages for a variety of system for all the points (or rock particles) that end up at the nodes of the topographic file at the end of the run. It also computes these ages at intermediary times as specified in the <code>Pecube.in</code> file by the <code>output<strong><em>i</em></strong></code> flag. If this flag is set to 1 for <strong>n</strong> steps (including the last step corresponding to present-day), <strong>Pecube</strong> will generates <strong>n</strong> ages files named <code>Ages001.csv</code> to <code>Ages00n.csv</code>, starting from the oldest to the youngest age.</p>
</div>
<div class="paragraph">
<p>Each file contains a table that include, as columns:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Longitude</p>
</li>
<li>
<p>Latitude</p>
</li>
<li>
<p>Height</p>
</li>
<li>
<p>Apatite Helium age</p>
</li>
<li>
<p>Zircon Helium age</p>
</li>
<li>
<p>Apatite Fission track age</p>
</li>
<li>
<p>Zircon aFission track ge</p>
</li>
<li>
<p>K-Feldspar K-Argon age</p>
</li>
<li>
<p>Biotite K-Argon age</p>
</li>
<li>
<p>Muscovite K-Argon age</p>
</li>
<li>
<p>Hornblend K-Argon age</p>
</li>
<li>
<p>Apatite Fission track mean track length</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Longitudes and latitudes are in decimal degrees, height is in meters, Ages are in Myr and length in microns Each row corresponds to a point on the topographic mesh. Note that only selected ages are computed, as instructed by the user in the <code>Pecube.in</code> file through the various <code>age_xxx_flags</code>. See section <a href="#OUTPUTPARAMS">Output parameters</a> for details.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>French users are warned that <strong>Pecube</strong> uses English/US convention for <code>.csv</code> files, i.e. the columns are separated by commas <code>,</code>. To read those files into the French version of Excel or Numbers, the user needs to transform the <code>.csv</code> files generated by <strong>Pecube</strong>. For this we suggest to run a simple sed command that will do the job on a <strong>Pecube</strong> generated <code>.csv</code> file named <code>English.csv</code> that is transformed into a French <code>.csv</code> file named <code>French.csv</code> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>sed sed 's/,/;/g' English.csv | sed 's/./,/g' &gt; French.csv</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_comparisons_with_data">Comparisons with data</h4>
<div class="paragraph">
<p><strong>Pecube</strong> other main purpose is to compare its preditions to data. If the user provides data, <strong>Pecube</strong> will automatically predict this data. It will also generate several output files that compare predicted to observed ages, thermal histories, 43He or TL data. These are called:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CompareAGE.csv</code>, for the ages</p>
</li>
<li>
<p><code>CompareTT.csv</code>, for the thermal histories</p>
</li>
<li>
<p><code>Compare43HE.csv</code>, for the <sup>43</sup>He data</p>
</li>
<li>
<p><code>CompareTL.csv</code>, for the TL data</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These files have a simple structure made of columns that, in addition to latitude and longitude, give the observed (<code>OBS</code>) and predicted (<code>PRED</code>) quantities. Each row corresponds to an observation/sample.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To extract from <strong>Pecube</strong> synthetic ages at specific points (i.e. that are not nodes of the topographic grid), the user should include a <code>fake</code> data A-file that contains only longitude and latitude information and no ages. <strong>Pecube</strong> will then produce synthetic ages at these points.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_time_temperature_paths">Time temperature paths</h4>
<div class="paragraph">
<p><strong>Pecube</strong> will also exports computed time-temperature paths at the observation points (i.e. where data has been provided by the user) if the flag <code>save_PTT_paths</code> has been set to 1 in the <code>Pecube.in</code> input file. This information is stored in the <code>TimeTemperaturePaths.csv</code> file in the <code>output</code> folder.</p>
</div>
<div class="paragraph">
<p>The format of the <code>TimeTemperaturePaths.csv</code> file is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>as many rows as there are times in the thermal history</p>
</li>
<li>
<p>as many columns as there are points to track + 1</p>
</li>
<li>
<p>the first column is the time</p>
</li>
<li>
<p>the other columns are the temperatures of each of the points to track</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_eroded_volumes">Eroded volumes</h4>
<div class="paragraph">
<p>On request, a file containing the evolution through time of eroded volume is produced by <strong>Pecube</strong>. It is called <code>VolumeEroded.csv</code> and is stored in the <code>output ` folder. To generate the eroded volumes file, the flag `</code> must be set to 1 in the <code>Pecube.in</code> input file.</p>
</div>
<div class="paragraph">
<p>The format of the <code>VolumeEroded.csv</code> file is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>four columns and as many rows as there are time intervals</p>
</li>
<li>
<p>the first two colums are the start and end of each time interval in Myr</p>
</li>
<li>
<p>the thrid column is the flux or volume per unit time in km<sup>3</sup>/Myr</p>
</li>
<li>
<p>the fourth column is the cumulative eroded volume in km<sup>3</sup></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vtk_files">VTK files</h3>
<div class="paragraph">
<p><strong>Pecube</strong> also generates <code>.vtk</code> files that can be used to visualize the results of a model run using the Paraview software.</p>
</div>
<div class="paragraph">
<p>These include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Ages00<strong><em>i</em></strong>.vtk</code> files that contain surface ages computed by <strong>Pecube</strong></p>
</li>
<li>
<p><code><strong>Pecube</strong>00<strong><em>i</em></strong>.vtk</code> files that contain the temperature structure computed by <strong>Pecube</strong></p>
</li>
<li>
<p><code>Topo00<strong><em>i</em></strong>.vtk</code> files that contain surface topography given to <strong>Pecube</strong></p>
</li>
<li>
<p><code>fault00<strong><em>i</em></strong>.vtk</code> files that contain fault geometries given to <strong>Pecube</strong></p>
</li>
<li>
<p><code>velo00<strong><em>i</em></strong>.vtk</code> files that contain velocity fields computed by <strong>Pecube</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>where <strong>i</strong> is the number of the time step among those that have been saved as indicated in the <code>Pecube.in</code> input file through the <code>output*<strong><em>i</em></strong></code> flags.</p>
</div>
<div class="paragraph">
<p><strong>Pecube</strong> also generates a file named <code>Data.csv</code> stored in the <code>VTK</code> folder that contains the location of the observations provided to <strong>Pecube</strong>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>.vtk</code> files are not generated by <strong>Pecube</strong> <em>per se</em> but by two other programs called <code>Test</code> and <code>Vtk</code> that are stored in binary form in the <code>bin</code> folder. These programs are automatically called when the user issues a <code>bin/run.sh $RUN</code> command, where $RUN is the name of the project being run. They can also be used individually by issuing one the the two following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>bin/Test $RUN</pre>
</div>
</div>
<div class="paragraph">
<p>to generate the <code>Topo00<strong><em>i</em></strong>.vtk</code>, <code>fault00<strong><em>i</em></strong>.vtk</code> and `velo00<strong><em>i</em></strong>.vtk`files, and/or</p>
</div>
<div class="listingblock">
<div class="content">
<pre>bin/Vtk $RUN</pre>
</div>
</div>
<div class="paragraph">
<p>to generate the <code><strong>Pecube</strong>00<strong><em>i</em></strong>.vtk</code> and `Ages00<strong><em>i</em></strong>.vtk`files</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Paraview is a very powerful yet free software that is widely used to represent scietific data in 3D. The author strongly recommends to <strong>Pecube</strong> users to learn the basics of Paraview as well as a=some of its advanced features to analyse <strong>Pecube</strong> predictions in details.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_bin_files">BIN files</h3>
<div class="paragraph">
<p>Everytime <strong>Pecube</strong> runs it generates two binary output files that are used for post-processing. Note that this does not apply when <strong>Pecube</strong> is run in <em>Inversion</em> mode. These two files are called <code>Pecube.out</code> and <code>Ages.out</code> and are stored in the <code>output</code> folder. The first one contains the complete temperature history computed by <strong>Pecube</strong>, as well as the surface geometry and the velocity used to copmute the thermal histories. The second contains the ages as computed by <strong>Pecube</strong>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The binary files exist mostly for legacy reasons. They should not be used by the user. If a user needs access to the complete temperature structure, for example, the author should be contacted for further information on how to access these binary files.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_log_file">Log file</h3>
<div class="paragraph">
<p>When the debugging mode is activated, <strong>Pecube</strong> activity is logged in a log file called <code>Pecube.log</code> stored in the <code>LOG</code> folder. The information sent to the log file is for debugging purposes and of little use to the user. To enable debugging mode, the user must set the <code>debug</code> to 1 in the <code>Pecube.in</code> file.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_feeding_data_to_pecube"><a id="Feeding_data_to_Pecube"></a>Feeding data to Pecube</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Pecube</strong> accepts many types of data, mostly ages but not exclusively. <strong>Pecube</strong> makes use of data in two separate ways: First, <strong>Pecube</strong> can be used to reproduce observations by computing synthetic values at the same locations, second it can use these synthetic values to compare them to the observations and to direct the search for optimal values of model parameters, when used in its <em>Inversion</em> mode.</p>
</div>
<div class="paragraph">
<p>All data must be stored in <code>.csv</code> files that contains informative labels to help <strong>Pecube</strong> access the data. For example a data file that contains Apatite Helium ages and their uncertainty at a set of <code>n</code> locations must contain, at minima five columns: one containing the name of each sample, two containing the latitude and longitude of each sample and two containing the age and its uncertainty. There may be more columns that contain other information useful for <strong>Pecube</strong>, like Apatite fission track ages, for example, or not, like the age of the geologist who collected the data. That &#8220;useless&#8221; information is managed by <strong>Pecube</strong> but not used.</p>
</div>
<div class="paragraph">
<p>Some data types require a different format. For example raw fission track length measurements that consist in a large collection of number (~100) each corresponding to a discrete track length measurement. This data is stored in a file where columns containing the sample name, its latitude and longitude are necessary but also a column that contain more than one number, i.e. the fission track length measurements.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that two distinct methods/formats can be used to input a fission track length dataset, the first, as described above, by reading in a long list of track length measurements, the second by reading a fission track length distribution that has already been computed by the user from the raw fission track length dataset.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All data files must be stored inside one sub-folder in the <code>data</code> folder. The name of the subfolder is passed to <strong>Pecube</strong> through the <code>Pecube.in</code> input file under the tag/name <code>data_folder</code>. The user can create more than one data subfolder to group the various datafiles in intended combinaisons. There are five different types of data files, age datafiles (A_files), fission track length data files (FTL_files), thermal histories data files (TH_files), <sup>43</sup>He datafiles (43_files) and thermoluminescence datafiles (TL_files).</p>
</div>
<div class="sect2">
<h3 id="_conventions">Conventions</h3>
<div class="paragraph">
<p>All data files must be in <code>.csv</code> format. This means that they can be prepared in your favorite data analysis software (like Excel or Numbers) and exported as <code>.csv</code>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>French users are warned that Excel (or Numbers) export data in <code>.csv</code> format that are not comma separated but semi-colon separated because the comma is used in the numbers themselves (to separate the fractional part from the integer part of the number). This will not work with <strong>Pecube</strong> which expects COMMA separated data with a dot <code>.</code> used for decimal numbers. French users will therefore need to modify their input data to make them conpatible with <strong>Pecube</strong>. For this we suggest to run a simple sed command that will do the job on a French <code>.csv</code> file named <code>French.csv</code> that is transformed into a US/English <code>.csv</code> file named <code>English.csv</code> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>sed 's/,/./g' French.csv | sed 's/;/,/g' &gt; English.csv</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To recognize data file types and the data inside the files, <strong>Pecube</strong> does not use data file names, but the tags/labels of the columns inside the files. For example, any data/sample in any file must contain a colum names <strong>SAMPLE</strong> and two other columns names <strong>LON</strong> and <strong>LAT</strong>. Apatite Helium ages are stored in a column named <strong>AHE</strong> and their uncertainties in <strong>DAHE</strong>.</p>
</div>
<div class="paragraph">
<p>The convention is that the capitalization of the tag does not matter, i.e., <strong>ahe</strong> is equivalent to <strong>AHe</strong> or to <strong>AHE</strong>.</p>
</div>
<div class="paragraph">
<p>The order of the columns (or tags) does not matter. The first column can be the sample name, but it does not have to be.</p>
</div>
<div class="paragraph">
<p>Some colums can be empty and some lines can be empty.</p>
</div>
<div class="paragraph">
<p>Some columns may contain data that is not meaningful for <strong>Pecube</strong>; they will not be read but should not interfere with the meaningful information. Avoid, however, cluttering your <code>.csv</code> data files with useless information that increases the chance that your data be not read appropriately by Peube.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Where a data is expected, the user should use numerical values that make sense, such as <code>1.2</code> or <code>1.e-3</code> or <code>0.0023</code>. But not values that cannot be interpreted as real numbers, such as <code>1+1</code> or <code>Nil</code> or <code>NoData</code>. If a type of data is missing for a sample, leave the corresponding entry empty.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_data_types">Data types</h3>
<div class="paragraph">
<p>In the following table, we give the list of tags that are expected (&#8730;) or allowed (+) in each of the five different data type files.</p>
</div>
<div class="paragraph">
<p>[[Data types]]</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Data type</th>
<th class="tableblock halign-left valign-top">Tag</th>
<th class="tableblock halign-left valign-top">A_files</th>
<th class="tableblock halign-left valign-top">FTL_files</th>
<th class="tableblock halign-left valign-top">TH_files</th>
<th class="tableblock halign-left valign-top">43_files</th>
<th class="tableblock halign-left valign-top">TL_files</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sample name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SAMPLE</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sample longitude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>LON</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sample latitude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>LAT</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sample height</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>HEIGHT</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apatite Helium age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AHE</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uncertainty on Apatite Helium age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DAHE</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apatite fission track age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AFT</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uncertainty on Apatite fission track age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DAFT</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Zircon Helium age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ZHE</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uncertainty on Zircon Helium age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DZHE</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Zircon fission track age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ZFT</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uncertainty on Zircon fission track age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DZFT</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">K-feldspar K-Ar age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>KAR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uncertainty in K-feldspar K-Ar age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DKAR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Biotite K-Ar age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>BAR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uncertainty in Biotite K-Ar age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DBAR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Muscovite K-Ar age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>MAR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uncertainty in Muscovite K-Ar age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DMAR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hornblende K-Ar age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>HAR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uncertainty in Hornblende K-Ar age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DHAR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Grain size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SIZE</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relative proportion of FT lengths in 0-1 &#181;m range</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>TL1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relative proportion of FT lengths in --- &#181;m range</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>TL--</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relative proportion of FT lengths in 19-20 &#181;m range</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>TL20</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fission track lengths</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>FTL</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time point</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>TIMEH</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temperature point</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>TEMPH</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uncertainty on temperature</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DTEMPH</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><sup>43</sup>Helium age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AGE43</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uncertainty on <sup>43</sup>Helium age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DAGE43</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Heating step duration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DUR43</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Heating step temperature</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>TEMP43</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relative gas release</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>%REL</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relative gas release</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>D%REL</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Age gas release</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AREL</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relative gas release</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DAREL</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dose rate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DOSER</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Onset of dose saturation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>D0</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kinetic orders of trapping</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ATL</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kinetic orders of detrapping</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>BTL</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Activation energy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ET</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logarithm of thermal frequency factor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>LOGS</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logarithm of dimensionless recombination center density</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>LOGRHO</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relative number of trapped electrons</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>N/N</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8730;</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>All ages and times are in Myr, all temperatures are in &#176;C, all longitudes and latitudes are in decimal degrees, heights are in meters, fission track lengths and grain sizes are in microns, Step durations are in minutes, dose rates are in Gyr/kyr, onset of dose saturation in Gyr, and energies are in eV.</p>
</div>
<div class="sect3">
<h4 id="_a_files">A_files</h4>
<div class="paragraph">
<p>Ages files (A_files) are the original <strong>Pecube</strong> files. They contain age (and age uncertainty) data for a given number of samples. Each sample is a row in the file and each system/age or data is a column in the file. The tags that are searched for in an A-file are: <strong>SAMPLE</strong> (compulsory), <strong>LON</strong> (compulsory), <strong>LAT</strong> (compulsory), <strong>HEIGHT</strong>, <strong>AHE</strong>, <strong>DAHE</strong>, <strong>AFT</strong>, <strong>DAFT</strong>, <strong>ZHE</strong>, <strong>DZHE</strong>, <strong>ZFT</strong>, <strong>DZFT</strong>, <strong>KAR</strong>, <strong>DKAR</strong>, <strong>BAR</strong>, <strong>DBAR</strong>, <strong>MAR</strong>, <strong>DMAR</strong>, <strong>HAR</strong>, <strong>DHAR</strong>, <strong>TL1</strong> to <strong>TL20</strong> and <strong>SIZE</strong>. All other tags are not read. Missing data points are allowed.</p>
</div>
<div class="paragraph">
<p>Example of an A_file:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">SAMPLE</th>
<th class="tableblock halign-left valign-top">LON</th>
<th class="tableblock halign-left valign-top">LAT</th>
<th class="tableblock halign-left valign-top">HEIGHT</th>
<th class="tableblock halign-left valign-top">AHE</th>
<th class="tableblock halign-left valign-top">DAHE</th>
<th class="tableblock halign-left valign-top">AFT</th>
<th class="tableblock halign-left valign-top">DAFT</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sample1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-23.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1321</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.2</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AK-123/23</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-22.8</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">14.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dummy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-23.2</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dummy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-23.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-200</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The first sample has Apatite Helium data only, the second Apatite fission track only and no information about the height, the third is a dummy sample which is used to extract age information from <strong>Pecube</strong> at a selected site, the fourth is identical to the third except that the user has specified a negative number for the <strong>HEIGHT</strong> field, which means that the age will be calculated at a depth of 200 meters below the surface (as if it had been collected in a well)</p>
</div>
</div>
<div class="sect3">
<h4 id="_ftl_files">FTL_files</h4>
<div class="paragraph">
<p>Fission track length files (FTL_files) contain fission track length measurements for a given number of samples. To each sample sample corresponds a number of rows in the file that contains the fission track length data. The tags that are searched for in an A-file are: <strong>SAMPLE</strong> (compulsory), <strong>LON</strong> (compulsory), <strong>LAT</strong> (compulsory), <strong>HEIGHT</strong> and <strong>FTL</strong> (compulsory). All other tags are not read.</p>
</div>
<div class="paragraph">
<p>Example of a FTL_file:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">SAMPLE</th>
<th class="tableblock halign-left valign-top">LAT</th>
<th class="tableblock halign-left valign-top">LON</th>
<th class="tableblock halign-left valign-top">HEIGHT</th>
<th class="tableblock halign-left valign-top">FTL</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KK123/1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-45.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">178.12</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">13</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KK123/2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-45.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">178.12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1245</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">13</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">17</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The first sample has 9 track length measurements but no <strong>HEIGHT</strong> field; the second sample has only 4 track length measurements but has a height.</p>
</div>
</div>
<div class="sect3">
<h4 id="_th_files">TH_files</h4>
<div class="paragraph">
<p>There exist several methods/pieces of software to extract thermal histories from thermochonometric data (HEFTY, QTQT for example). A new option allows to use these thermal histories to constrain <strong>Pecube</strong>, avoiding the need to perform age calculations in <strong>Pecube</strong>. In this way the user combines the strength of thermal history software such as QTQT with the strength of <strong>Pecube</strong>, designed to test tectonogeomorphic against thermal histories.</p>
</div>
<div class="paragraph">
<p>Thermal history files (TH_files) contain thermal histories for one or several samples. To each sample corresponds a number of rows in the file that contains the thermal history of the sample under the tags <strong>TIMEH</strong>, <strong>TEMPH</strong> and <strong>DTEMPH</strong>, that correspond to the time, temperature and uncertainty on temperature for each of the points of the thermal history. Times are in Myr in the past (geological time) and temperature and uncertainty on temperature are in &#176;C.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The thermal histories must be given in chronological order, i.e., form the oldest point to the youngest; they do not need, however, to be monotonous.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Example of a FTL_file:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">SAMPLE</th>
<th class="tableblock halign-left valign-top">LAT</th>
<th class="tableblock halign-left valign-top">LON</th>
<th class="tableblock halign-left valign-top">HEIGHT</th>
<th class="tableblock halign-left valign-top">TIMEH</th>
<th class="tableblock halign-left valign-top">TEMPH</th>
<th class="tableblock halign-left valign-top">DTEMPH</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KK123/1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-45.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">178.12</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">250.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">25.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">200.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">25.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">125.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">25.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">75..</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KK123/2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-45.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">178.12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1245</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">66.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">250.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">55.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">350.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The first sample has a monotonous thermal history made of 5 points but no <strong>HEIGHT</strong> field; the second sample has a non-monotonous thermal history made of 4 points but has a height.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>DO NOT specify NIL UNCERTAINTY as the uncertainty appears in the denominator in the expression of the misfit function.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_43_files">43_files</h4>
<div class="paragraph">
<p>Experimental (not fully tested)</p>
</div>
</div>
<div class="sect3">
<h4 id="_tl_files">TL_files</h4>
<div class="paragraph">
<p>Experimental (not fully tested)</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_checking_the_data">Checking the data</h3>
<div class="paragraph">
<p><strong>Pecube</strong> performs a series of simple check on the data. First it discards the points that are not located within the <strong>Pecube</strong> domain (defined by the geometry of the topographic file or DEM). It then looks for inconsistencies in the data such as a thermal hitory that has no temperature column, or a data point that it cannot locate because it has no longitude or latitude. Samples that do not have a sample name are not considered either.</p>
</div>
<div class="paragraph">
<p>If <strong>Pecube</strong> detects an error it will interrupt the run and send an error message. If <strong>Pecube</strong> notice a non-fatal inconsistency in the data it will report it in a file called <code>data_folder_Message.txt</code> (where <code>data_folder</code> is the name of the data_folder specified in the input file) stored in the <code>data</code> folder.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_inversion"><a id="Inversion"></a>Inversion</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Pecube</strong> can be used in <em>Inversion</em> mode to explore/find the value of seleceted parameters that produce ages that best fit observations/data provided by the user. The <em>Inversion</em> mode makes use of the Neighbourhood Algorithm (NA) developed by Malcolm Sambridge (Sambridge, 1999a, 1999b).</p>
</div>
<div class="paragraph">
<p>NA explores the parameter space by randomly generating sets of model parameters (one set per forward model run of <strong>Pecube</strong>). It performs this task a set number of times (or iterations). At the end of each iteration, NA constructs the Voronoi diagram around the points in parameter space that correspond to each model run (and set of parameters) performed during previous iterations. It will then select a finite number of the best Voronoi cells (those that are charcterized by a small value of the misfit function) to resample in the next iteration. It will perform model runs by selecting model parameter sets that are contained in those Voronoi cells only. During the first iteration NA performs a set number of model runs corresponding to sets of parameters uniformly distributed in the entire parameter space.</p>
</div>
<div class="paragraph">
<p>NA explores parameter space in order to minimize a misfit function that measures the difference between observations and predictions. This function is made up of various components that are added to each other and correspond to different types of data/observations.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Using <strong>Pecube</strong> in <em>Inversion</em> mode implies that it is provided with data that <strong>Pecube</strong> will attempt to match by searching through parameter space (using NA). There is no point in performing an inversion if no data is provided to <strong>Pecube</strong>. Note, however, that synthetic ages can be provided to <strong>Pecube</strong> to peform an inversion. This is a way to estimate the quality/quantity of data that is necessary to verify/discard a proposed scenario.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_parameters_to_invert_for">Parameters to invert for</h3>
<div class="paragraph">
<p>Any of <strong>Pecube</strong> parameters can be inverted for. They are selected by the user by specifying a range rather than a single value in the input file (<code>Pecube.in</code>). The range is given by two numbers (rather than one) separated by a column <code>:</code>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Some parameters cannot be inverted for. For example those that do not have a numerical value, like a file name, or are just flags or integers that can only take a discrete number of values. USE COMMON SENSE when deciding which parameter you wish to invert for.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>Some parameters appear as a series of numbers, such as the various times in the topographic or velocity history, or the successive coordinates of the points defining a fault geometry. In these situations, the user can use a star <code>*</code> instead of a time or coordinate value. This instructs NA to set the range for this parameter to be whatever value NA has selected for the previous value in the series and/or the next one. This of course does not apply for the first or last unmber in the series.</p>
</li>
<li>
<p>Note that this causes a strong correlation between two (or more) of the parameters NA is inverted for. This has soncequences for the way you shold interpret the outcome/result of the inversion.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_misfit_function">Misfit function</h3>
<div class="paragraph">
<p>The misfit function is composed of 5 parts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the age part</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>M1 = sqrt(sum [(Ao-Ap)^2^/dA^2^]/N1)</pre>
</div>
</div>
<div class="paragraph">
<p>where Ao, dA and Ap are the observed, uncertainty in and predicted ages, N1 is the total number of age constraints. Note that in case the age-elevation relationship is used rather than the "raw" ages (<code>misfit_slope = 1</code>), the misfit function is constructed from the mean age Am and slope of the age-elevation relationship AEs, obtained by linear regression of the observed/predicted ages vs elevations. The misfit function (M1) is replaced by the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>M1 = sqrt(sum [(Amo-Amp)^2^/Amo^2^+(AEso-AEsp)^2^/AEso^2^]/Na)</pre>
</div>
</div>
<div class="paragraph">
<p>where the summation is over the different age/systems used/available and Na is their number.
- the fission track length part</p>
</div>
<div class="listingblock">
<div class="content">
<pre>M1a = Kuiper test comparing observed and predicted track length distributions</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>the thermal history part</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>M2 = sqrt(sum [(To-Tp)^2^/dT^2^]/N2)</pre>
</div>
</div>
<div class="paragraph">
<p>where To, dT and Tp are the observed, uncertainty in and predicted temperature, N2 is the total number of steps in the thermal histories
- the <sup>43</sup>He part</p>
</div>
<div class="listingblock">
<div class="content">
<pre>M3 = sqrt(sum [(Ro-Rp)^2^/(0.1*Ro)^2^]/N3)</pre>
</div>
</div>
<div class="paragraph">
<p>where Ro and Rp are the observed, uncertainty and predicted percent gas release, N3 is the total number of steps in the step heating procedure
- the Thermo Luminescence part</p>
</div>
<div class="listingblock">
<div class="content">
<pre>M4 = sqrt(sum [(NNo-NNp)^2^/dNN^2^]/N4)</pre>
</div>
</div>
<div class="paragraph">
<p>where NNo, dNN and NNp are the observed, uncertainty in and predicted NN, N4 is the total number of TL observations</p>
</div>
</div>
<div class="sect2">
<h3 id="_na_behaviour">NA behaviour</h3>
<div class="paragraph">
<p>In <em>Inversion</em> mode, <strong>Pecube</strong> performs not one but MANY forward model runs. This means that the computational time is greatly increased (by a factor of several thousands in most cases). This implies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>that the user should consider limiting the cost of a single forward model run: for this the user should consider increasing the value of the stride parameter (<code>nskip</code>) to lower the horizontal resolution used in <strong>Pecube</strong>; the user should also consider decreasing the value of the vertical spatial resolution (<code>nz</code>); to help the user, all flags selecting which ages to calculate at the horizontal grid points are automatically turned off (i.e. set to 0);</p>
</li>
<li>
<p>that the user should try to limit the number of forward model runs performed during the inversion: for this the user should consider minimizinfg the number of model parameters to invert for; this is because the number of points necessary to sample a space of dimension <code>N</code> increases almost exponentially with the diemension <code>N</code>; NA is recommended for highly nonlinear problem having a relatively small number of parameters (&lt;10);</p>
</li>
<li>
<p>that the user should try to use a multi-processors/cores machine: we provide the user with a version of <strong>Pecube</strong> that is optimized for running on a multi processor machine by makeing of MPI (Message Passing Interface); to use this feature, the user have a purposedly compiled version of <strong>Pecube</strong> or create it by issuing the <code>make MPI</code> command; this requires that the adequate libraries and compiler options have been installed on the computer.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_inversion_results">Inversion results</h3>
<div class="paragraph">
<p>The results of the inversion are written to a series of files stored in the <code>NA</code> folder. The main output  is saved at the end of the <strong>Pecube</strong> inversion in the file <code>NA_results.csv</code> which contains <code>nparam + 1</code> columns where <code>nparams</code> is the number of parameters inverted for. The first colum contains the value of the misfit and the others the corresponding values of the model parameters.</p>
</div>
<div class="paragraph">
<p>Another similar file is stored in the <code>NA</code> folder. It is called <code>NA_int_res.csv</code> and contains the same information as that contained in <code>NA_results.csv</code> but is updated in real time during the inversion run. It is possible that this file be corrupted when <strong>Pecube</strong> runs in <em>Inversion</em> mode using multiple processors/cores. This is the reason the other file <code>NA_results.csv</code> is created at the end of the inversion.</p>
</div>
<div class="paragraph">
<p>To access these files, an R-script is provided (in the tools directory). It is called <code>NA.R</code> and can read the files and display their content in several ways. In particular <code>NA.R</code> produces diagrams representing each model run by a colored dot/circle that are very useful to assess the evolution of the misfit function and map the function in parameter space. We recommend its use.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Don&#8217;t forget to run the <code>NA.R</code> script from the main <strong>Pecube</strong> folder&#8230;&#8203;</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Alternatively, we suggest to the user to use the second part of Malcolm Sambridge&#8217;s software package that builds from the model run a more sophisticated statistical information, such as a probability Density Function for each of the model parameters <strong>Pecube</strong> has inverted the observations for. Malcolm Sambridge&#8217;s second piece of software reads the <code>NA.nad</code> file that has also been generated by the <strong>Pecube</strong> + NA run.</p>
</div>
<div class="paragraph">
<p>When run in <em>Inversion</em> mode, <strong>Pecube</strong> issues a single line to the screen per model run. It contains the misfit value and th ecorresponding model parameter values. All other information is removed.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_examples">Examples</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_exmp1">EXMP1</h3>
<div class="paragraph">
<p>In this first example <a href="input/EXMP1.html">Pecube.in</a>, we perform a simple experiment using a flat surface topography (no <code>topo_file_name</code> is specified). The grid is of dimension 21x21 kilometers (approximately) as the default grid spacings <code>dlon = 0.0083333</code> and <code>dlat = 0.0083333</code> are used. The experiment goes for 10 million years as specified by <code>time_topo1 = 10</code>. We impose a uniform uplift <code>npoint = -1</code> set to <code>velo1_1 = 2</code> over the complete experiment time, i.e. from <code>time_start1_1 = 10</code> to <code>time_end1_</code> = 0`.</p>
</div>
<div class="paragraph">
<p>The predcited Apatite Helium age is 0.84 Ma and the T-t or Temperature-time path for a particle in the middle of the model is shown in the following figure. To extract that information, we introduced a "fake" data file that only contains one point of which the lcatitude and longitude only are specified and set <code>save_PTT_paths = 1</code>. We see the exponential shape of the Tt path which simply reflects the exponentional geotherm being established by the finite advection of rocks through th eupper fixed surface. This is due to the finite value of the "Peclet" number (<code>Pe = vL/k</code>) where <code>v</code> is the exhumation velocity, <code>L</code> the thickness of the layer being exhumed and <code>k</code> the thermal diffusivity. In this example, <code>v = 2 km/Myr</code>, <code>L = 35km</code> and <code>k = 25 km<sup>2</sup>/Myr</code>, such that <code>Pe = 2*35/25 = 2.8</code>.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/Ttpath.jpg" alt="Tt-path extracted from **Pecube**" width="500" height="300">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exmp2">EXMP2</h3>
<div class="paragraph">
<p>In this second example <a href="input/EXMP2.html">Pecube.in</a>, we use a finite amplitude topography arbitrarily extracted from the global topographic database <code>topo30</code> at the locatino of Kings Canyon in the Sierra Nevada of Souther California. For this we specify the latitude and longitude of the bottom left corner of the area of interest and cut out a sqaure of dimensions 60x60 km approximately.</p>
</div>
<div class="paragraph">
<p>The results are shown as two plots of the resulting Apatite Helium ages, one assuming that the topography remains constant through time <a href="input/EXMP2.html">Pecube.in</a>, the other that the topography amplitude has decreased from 3 times its present-day amplitude at 10 Ma to its present-day amplitude at 0 Ma <a href="input/EXMP2b.html">Pecube.in</a>. This is imposed by changing the <code>amplification1</code> to 1 or 3, respectively. In the first case we see a strong positive age-elevation relationship at all wavelengths. In the second case we see a strong negative age-elevation relationship at the longest wavelengths of the topography and a positive age-elevation relationship at short wavelength. See Braun (Terra Nova, 2002) for further explanation of this behaviour.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/KG1.jpg" alt="Predicted AHe ages for a constant amplitude topography" width="500" height="500">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/KG2.jpg" alt="Predicted AHe ages for a decreasing amplitude topography" width="500" height="500">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that to obtain the <code>.vtk</code> files necessary to produce the 3D plots one needs to execute <code>bin/Vtk EXMP2</code></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="EXMP3">EXMP3</h3>
<div class="paragraph">
<p>This example <a href="input/EXMP3.html">Pecube.in</a> is very similar to the previous one, except that the topographic history is more complex, i.e. made up of more than one step. There are three steps, one that starts at 90 Ma when the topography is 3 times higher than present-day, one that starts at 70 Ma when the topography is still 3 times higher than today. This represents the tectonically active phase. We then impose that the relief disappears completely over the interval starting at 70 Ma and finishing at 5 Ma to form a flat plateau at 1 km elevation. Finally the topography is recreated (to its present-day value) in the last 5 Ma to mimic an erosional response to a climate change, for example (by setting <code>offset3 = 1</code>). The velocity field is relatively fast (1 km/Myr) during the tectonic phase (between 90 and 70 Ma). Them much slower, i.e. 0.04 km/Myr, during the interval (70-5 Ma).</p>
</div>
<div class="paragraph">
<p>Note that <code>nskip = 2</code> to force <strong>Pecube</strong> to use half the resolution (in each direction) of the input DEM. In fact, <strong>Pecube</strong> only uses every second point in the DEM (in both directions). Note also the use of a start * to impose that the time of the start of the second interval of the velocity scenario is equal to the time of the end of the first interval.</p>
</div>
<div class="paragraph">
<p>The resulting topography, Apatite Helium ages and 3D temperature structure ar eshown in the following figure. It shows the evolution of the topography, as imposed, the very large variation in ages a the end of the model run, as well as the advection of the isotherms during the tectonic phase.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock text-center">
<div class="content">
<img src="images/Step1.jpg" alt="Surface topography, AHe ages and thermal structure at 90 Ma" width="400" height="400">
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock text-center">
<div class="content">
<img src="images/Step2.jpg" alt="Surface topography, AHe ages and thermal structure at 70 Ma" width="400" height="400">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock text-center">
<div class="content">
<img src="images/Step3.jpg" alt="Surface topography, AHe ages and thermal structure at 5 Ma" width="400" height="400">
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock text-center">
<div class="content">
<img src="images/Step4.jpg" alt="Surface topography, AHe ages and thermal structure at 0 Ma" width="400" height="400">
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note the very large spread of ages on the present-day landscape. The age distributions at the other time steps should be compared to detrital age distributions that would be obtained from a sedimentary unit of the equivalent stratigraphic age.</p>
</div>
</div>
<div class="sect2">
<h3 id="_exmp4">EXMP4</h3>
<div class="paragraph">
<p>In this example, we introduce two thrust faults that will be activated in sequence. For simplicity we will assume that the topography is flat. They are made of two segments each, a horizontal segment at 10 km depth and a dipping segment at 45&#176; dip. The faults are offset by 20 km. We assume that the motion on the first fault last between 10 and 5 Ma and that motion on the second fault lasts between 5 and 0 Ma. The velocity does not change over time and is set at 1 km/Myr. Here is the resulting <a href="input/EXMP4.html">Pecube.in</a>.</p>
</div>
<div class="paragraph">
<p>The results are shown in the two figures below and show the resulting velocity field at 5 Ma and at present-day, as well as the predicted Apatite Helium ages at the end of the run. The distribution of ages is made of very young ages near the most recent fault and intermediary ages above the first structure. Note that the faults have not bee advected one by the other which, in this situation of in-sequence faulting, makes no difference for the predicted age distribution.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/Velo1.jpg" alt="Velocity field at 5 Ma" width="500" height="500">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/Velo2.jpg" alt="Velocity field and predicted ages at present-day" width="500" height="500">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To display the velocity field with <code>Paraview</code>, you need to open the series of <code>veloxxx.vtk</code> files stored in the <code>VTK</code> folder. You then need to apply a <code>Glyph</code> filter to it to display the arrows. Importantly, the <code>Scalar mode</code> must be set to <code>vector</code> so that the arrows are scaled by the amplitude of the velocity.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_exmp5">EXMP5</h3>
<div class="paragraph">
<p>In this example we transform input files from the previous version of <strong>Pecube</strong> into the single input file for the current version. The "old" input files <a href="input/topo_parameters.html">topo_parameters.txt</a> and <a href="input/fault_parameters.html">fault_parameters.txt</a> have been placed in the <code>old_input</code> folder. Note that the run name in the <code>topo_parameters.txt</code> input file is <code>EXMP4</code>. This mean that a new folder called <code>EXMP5</code> will be created or overwritten with the version input file.</p>
</div>
<div class="paragraph">
<p>To perform the translation, the user should issue the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>bin/Pecube324</pre>
</div>
</div>
<div class="paragraph">
<p>The new format input file <a href="input/EXMP5.html">Pecube.in</a> will be stored as <code>EXMP5/input/Pecube.in</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that it is recommended to replace the <code>topo_file_name</code> <code>Whataroa.dat</code> by the generic <code>Topo30</code> to use the global DEM.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="EXMP6">EXMP6</h3>
<div class="paragraph">
<p>In this example <a href="input/EXMP6.html">Pecube.in</a> we show how to include a simple dataset into <strong>Pecube</strong>. The example is otherwise identical to that of <a href="#EXMP3">EXMP3</a>. The data is in a file stored in the folder that is given by the <code>data_folder</code> parameter, in this case <code>KGHelium</code>. The data file is named <a href="input/KingsCanyon.html">KingsCanyon.csv</a>. It contains He ages collected by House et al (1988) in the Kings Canyon area. The data file contains three compulsory columns names <code>SAMPLE</code>, <code>LON</code> and <code>LAT</code> that are needed to identify each data point/age and to position it in the model. The Apatite Helium data is stored in a column called <code>AHE</code>; the uncertainty in age in <code>DAHE</code>, the height of the sample location in <code>HEIGHT</code> and the grain size in the column <code>SIZE</code>. Units are given in the section near the <a href="#_data_types">Data types</a>. Note that the data file could contain empty columns or lines, or columns containing other information. These extra columns could be other ages (other chronometric systems) or a fission track length distribution. Columns that do not correspond to anything meaningful for <strong>Pecube</strong> are simply ignored.</p>
</div>
<div class="paragraph">
<p>When running <strong>Pecube</strong> (with the option <code>echo_input_file = 1</code>, it echoes to the screen the number of data points for each type of data. Note that all data types are considered as having potentially age information and are therefore added up to give the <code>Number of ages samples</code>. While reading the data, <strong>Pecube</strong> might produce comments concerning the data in a file called <code>data/xxx.txt</code> where <code>xxx</code> is the name of the data folder. These messages include information on the data that has been neglected because it is not located in the area modeled by <strong>Pecube</strong> or because it cannot be located (no <code>LAT</code> or <code>LON</code> column).</p>
</div>
<div class="paragraph">
<p>The comparison between the predicted and observed ages is given in the file <a href="input/CompareAGEKG.html">output/CompareAGE.csv</a>. It contains many columns that are now paired between an observation column and a prediction column. For example the <code>AHEOBS</code> column contains the observed Apatite Helium ages and the <code>AGEPRED</code> column contains the equivalent predicted ages.</p>
</div>
<div class="paragraph">
<p>We see that the predicted ages do not compare well with the data. A measure of this <code>misfit</code> is indicated by <strong>Pecube</strong>. The misfit is 4.93 as indicated by <strong>Pecube</strong>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_exmp7">EXMP7</h3>
<div class="paragraph">
<p>In this example, we will try to improve the fit to data obtained in <a href="#EXMP6">EXMP6</a>. For this we will use <strong>Pecube</strong> in <em>Inversion</em> mode. To achieve this, all that is needed is to replace one of several of the model parameters in the <a href="input/EXMP7.html">Pecube.in</a> file by a range. A range is specified by giving two numbers/values separated by a colon ":" rather than a single number/value. Here we will attempt to improve the fit to data by inverting for the exhymation rate in the second, slow phase of exhumation and the time at which that pahse starts (<code>time_start1_2</code>). We would like however the timing of the topographic scenario (defined by the <code>time_topoi</code> parameters). To achieve this, we synchronize the timing by specifying <code>time_start1_2 = time_topo2</code> in the input file and specify a range for the <code>time_topo2</code> parameter, in this case <code>time_topo2 = 70:100</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To perform this inversion in a reasonable (computing) time, we increased the <code>nskip</code> parameter.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To perform this inversion, <strong>Pecube</strong> will trigger not one but many model runs, varying the value of the model parameters between the two values given in the range. The values generated are produced by the Neighbourhood Algorithm (Sambridge, 1999). This algorithm first generates random parameter values in an attempt to explore parameter space in as uniform a manner as possible. <strong>Pecube</strong> estimates the misfit functionm for each of these parameter sets. The value of the model parameters and the misfit are echoed to the screen. Note that the misfit is made of 4 different parts (see section <a href="#Inversion">Inversion</a>) that are given separately to the screen, to help the user in determing the values of the various <code>misfit_weight_xxx</code> parameters (see section <a href="#Inversion_parameters">Inversion parameters</a>).</p>
</div>
<div class="paragraph">
<p>The results are shown in the following figure obtained using the <code>NA.R</code> R-script provided in the <code>tools</code> folder. It shows that the values of the second phase exhumation rate and its onset that best fit the data are 0.02 km/Myr and 85 Ma.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/Parameters_2x2.jpg" alt="Results of the inversion" width="500" height="500">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To perform inversions faster, we recommend that you use multiple processors/cores/threads on your computer as forward models can be performed simultaneously. Once you have installed MPI on your computer, you can use the multi-processor version of Pecube by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mpiexec -np xxx bin/PecubeMPI EXMP7</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>xxx</code> is the number of processors/cores/threads available on your computer/cluster.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_exmp8">EXMP8</h3>
<div class="paragraph">
<p>In this example, we use thermal histories as constraint for an inversion. The data stored in the <code>KGTpaths</code> is made of 4 samples for which we assumed time-temperature paths have been obtained using Hefty or QTQT (<a href="input/KC1.html">KC1.csv</a>, <a href="input/KC7.html">KC7.csv</a> and <a href="input/KC3-10.html">KC3-10.csv</a>). Note that one file contains two sample thermal histories.</p>
</div>
<div class="paragraph">
<p>The input file is <a href="input/EXMP8.html">here</a>.</p>
</div>
<div class="paragraph">
<p>The results are shown in the following figure.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/Parameters_2x2_EXMP8.jpg" alt="Results of the inversion" width="500" height="500">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exmp9">EXMP9</h3>
<div class="paragraph">
<p>In this other simple example <a href="input/EXMP9.html">Pecube.in</a>,we show how to extract predicted ages and a fission track length distribution at any point at the surface of the model. For this we introduce a <code>fake' data file that contains a point for which only the Lat-Lon information is given. We also change the value of the `FT_code_flag</code> to compare fission track length predictions from the two models used in <strong>Pecube</strong>, one by Peter van der Beek and one by Ritch Ketcham.</p>
</div>
<div class="paragraph">
<p>The code should be run twice, changing the value of <code>FT_code_flag</code> (0 or 1).</p>
</div>
<div class="paragraph">
<p>The results are stored in the file <code>output/CompareAGE.csv</code> (with <code>FT_code_flag=0</code>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">LON</th>
<th class="tableblock halign-left valign-top">LAT</th>
<th class="tableblock halign-left valign-top">AHEPRED</th>
<th class="tableblock halign-left valign-top">AFTPRED</th>
<th class="tableblock halign-left valign-top">ZHEPRED</th>
<th class="tableblock halign-left valign-top">ZFTPRED</th>
<th class="tableblock halign-left valign-top">KARPRED</th>
<th class="tableblock halign-left valign-top">BARPRED</th>
<th class="tableblock halign-left valign-top">MARPRED</th>
<th class="tableblock halign-left valign-top">HARPRED</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.100000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.100000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.36905</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.43820</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.19110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.76516</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.86970</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">71.9712</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">18.5794</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">98.4899</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">FT01PRED</th>
<th class="tableblock halign-left valign-top">FT02PRED</th>
<th class="tableblock halign-left valign-top">FT03PRED</th>
<th class="tableblock halign-left valign-top">FT04PRED</th>
<th class="tableblock halign-left valign-top">FT05PRED</th>
<th class="tableblock halign-left valign-top">FT06PRED</th>
<th class="tableblock halign-left valign-top">FT07PRED</th>
<th class="tableblock halign-left valign-top">FT08PRED</th>
<th class="tableblock halign-left valign-top">FT09PRED</th>
<th class="tableblock halign-left valign-top">FT10PRED</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0334822</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0296080</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0232002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">00.194468</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0135000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0151743</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0212498</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0362859</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0452934</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0598527</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">FT11PRED</th>
<th class="tableblock halign-left valign-top">FT12PRED</th>
<th class="tableblock halign-left valign-top">FT13PRED</th>
<th class="tableblock halign-left valign-top">FT14PRED</th>
<th class="tableblock halign-left valign-top">FT15PRED</th>
<th class="tableblock halign-left valign-top">FT16PRED</th>
<th class="tableblock halign-left valign-top">FT17PRED</th>
<th class="tableblock halign-left valign-top">FT18PRED</th>
<th class="tableblock halign-left valign-top">FT19PRED</th>
<th class="tableblock halign-left valign-top">FT20PRED</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0575817</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0569482</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0997214</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.130928</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.169413</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.174763</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0135517</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.00000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.00000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.00000</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The difference between the two predicted track length distributions is shown in the following figure.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/FTLDist.jpg" alt="Comparison between the two FTL distributions predicted by the two different codes" width="500" height="300">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exmpa">EXMPA</h3>
<div class="paragraph">
<p>Here we produce TL/OSL data, i.e. relative number of trapped electrons, at the surface of the topographic grid. The scenario (shown <a href="input/EXMPA.html">here</a>) involves the slow exhumation of rock under a flat topography, the rise of that topography to form a plateau at 6 km altitude and the incision of that plateau to form a very high relief topography (taken from one of the Himalayan syntaxes) over a relatively short amount of time. This scenario is created by changing both the <code>amplification</code> and the <code>offset</code> parameters used to describe topographic evolution in the input file.</p>
</div>
<div class="paragraph">
<p>Note that to predict TL/OSL data, values are needed for a range of parameters such as <code>TL_doser</code>, <code>TL_D0</code>, <code>TL_a</code>, <code>TL_b</code>, <code>TL_Et</code>, <code>TL_logs</code>, and <code>TL_logrho</code>. These can be set in the input file. They also have default values (see section <a href="#OUTPUTPARAMS">Output parameters</a>).</p>
</div>
<div class="paragraph">
<p>The results are shown in the following figure as contour of relative number of trapped electrons. The red areas corresponds to regions where <strong>Pecube</strong> predicts tha the signal is saturated.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/OSL.jpg" alt="Predicted TL data () on top of the final topography" width="500" height="300">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exmpb">EXMPB</h3>
<div class="paragraph">
<p>This example uses a series of topographic files (and uplift files) generated by a landscape evolution model, in this case <code>FastScape</code>. <code>FastScape</code> has a direct interface to <strong>Pecube</strong> allowing to sample a synthetic landscape generated by <code>FastScape</code> at any spatial and temporal resolution. For this one needs to specify the area to be extracted from the synthetic model as well as the spatial resolution (number of points in the x- and y-directions) and temperal resolution (frequency of output). This is shown in the <code>FastScape</code> <a href="input/FastScape.html">input file</a> that was used by <code>FastScape</code> to generate the synthetic landscapes used in this example by <strong>Pecube</strong>.</p>
</div>
<div class="paragraph">
<p>To access these synthetic landscapes, the resulting <code>topoxxx</code>, <code>tempxxx</code> and <code>upliftxxx</code> files must be stored in a subfolder of the <code>data</code> folder, in this case <code>BLCKU</code>. In the <strong>Pecube</strong> <a href="input/EXMPB.html">input file</a>, the <code>topo_file_name</code> has to be followed by a slash "/" to indicate that it is a folder.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Although the uplift function is specified in the <code>upliftxxx</code> files, the user is required to specify that there is a fault in the <code>Pecube.in</code> input file, i.e. <code>nfault = 1</code>, when using multiple files to provide topography and uplift <code>at will</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The results are shown in the following figure as predicted Apatite Helium ages on top of the final topography predicted by <code>FastScape</code>.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/FastScape.jpg" alt="Predicted Apatite Helium ages on top of the final topography predicted by FastScape" width="500" height="300">
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 4.0<br>
Last updated 2020-06-04 09:44:55 +0200
</div>
</div>
</body>
</html>